
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>wradlib data quality &#8212; Project Pythia Cookbook Template</title>
    
  <link href="../../_static/css/theme.css" rel="stylesheet">
  <link href="../../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-pythia-theme.min.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js"></script>
    <script src="../../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="wradlib Phase Processing - System PhiDP - ZPHI-Method" href="wradlib_differential_phase.html" />
    <link rel="prev" title="wradlib radar data io, visualisation, gridding and gis export" href="wradlib_radar_data_io_vis.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="132">
    <div class="container-fluid" id="shim"></div>
    <div class="container-fluid" id="banner"></div>
    <nav class="navbar navbar-dark navbar-expand-lg bg-dark fixed-top bd-navbar shadow" id="navbar-main"><div class="container-xl">

  <div id="navbar-start">
    
    

<a class="navbar-brand" href="https://openradarscience.org/erad2022/README.html">
  <img src="../../_static/erad_white_background.png" class="logo" alt="logo">
</a>


    
  </div>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbar-collapsible" aria-controls="navbar-collapsible" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  
  <div id="navbar-collapsible" class=" collapse navbar-collapse">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <ul id="navbar-main-elements" class="navbar-nav">
  
  <li class="nav-item">
    
    
    
    <a class="nav-link nav-internal" href="https://www.erad2022.ch">Conference Home</a>
  </li>
  
  <li class="nav-item">
    
    
    
    <a class="nav-link nav-internal" href="https://openradarscience.org">Open Radar Community</a>
  </li>
  
  
</ul>
      </div>
      
    </div>

    <div id="navbar-end">
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
        <li class="nav-item">
          <a class="nav-link" href="https://github.com/openradar/erad2022" rel="noopener" target="_blank" title="GitHub">
            <span><i class="fab fa-github-square"></i></span>
            <label class="sr-only">GitHub</label>
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="https://www.youtube.com/channel/UCoZPBqJal5uKpO8ZiwzavCw" rel="noopener" target="_blank" title="YouTube">
            <span><i class="fab fa-youtube-square"></i></span>
            <label class="sr-only">YouTube</label>
          </a>
        </li>
      </ul>
      </div>
      
    </div>
  </div>
</div>
    </nav>
    <div class="container-xl">
      <div class="row">
        
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../README.html">
   ERAD 2022 Open Radar Science Shortcourse
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Introductions + Overview
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../introductions/getting-started.html">
   Getting Started
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../introductions/open-science.html">
   An Overview of Open Science
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../../introductions/open-radar.html">
   Open Radar Community
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Tool Foundations
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../pyart/README.html">
   Py-ART Tutorial
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../pyart/pyart-basics.html">
     Py-ART Basics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../pyart/pyart-gridding.html">
     Py-ART Gridding
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../pyart/exercice1_swiss_thunderstorm.html">
     Filtering and retrievals on raw Swiss C-band data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../pyart/exercice2_swiss_doppler.html">
     Processing of Doppler wind data from a Swiss volumetric scan
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../pyart/question_pyart_meteoswiss.html">
     Exercice
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../pyart/answer_question_pyart_meteoswiss.html">
     Exercice Sample Solution
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="../../wradlib/README.html">
   Wradlib Tutorial
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="wradlib_intro.html">
     An Overview of wradlib
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="wradlib_radar_data_io_vis.html">
     wradlib radar data io, visualisation, gridding and gis export
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     wradlib data quality
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="wradlib_differential_phase.html">
     wradlib Phase Processing - System PhiDP - ZPHI-Method
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="wradlib_quasi_vertical_profiles.html">
     wradlib time series data and quasi vertical profiles
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../baltrad/README.html">
   BALTRAD Tutorial
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../baltrad_short_course/BALTRAD%20Compositing.html">
     Compositing with BALTRAD
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../baltrad_short_course/BALTRAD%20DRQC.html">
     In this notebook, we will use the depolarization ratio to quality control a volume of data from the new radar at Radisson, Saskatchewan
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../baltrad_short_course/BALTRAD%20IO.html">
     BALTRAD I/O model - making sense out of data and metadata
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../baltrad_short_course/BALTRAD%20parallel%20processing.html">
     BALTRAD parallel processing
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../baltrad_short_course/BALTRAD%20QC.html">
     BALTRAD Quality Control
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../lrose/README.html">
   LROSE Tutorial
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../lrose/nexrad_mosaic.erad_tutorial.html">
     ERAD 2022 Open Source Workshop
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../environment.html">
   Environment overview
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Open Radar Workflows
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../../workflows/README.html">
   Combining Radar Workflows
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../baltrad2wradlib/baltrad2wradlib.html">
     Interaction of BALTRAD and wradlib via ODIM_H5
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../pyart2baltrad/baltrad_pyart_rain_rate_example.html">
     In this notebook, an ODIM_H5 file is read using BALTRAD.  Then the rain rate is determined from the calculated specific attenuation using Py-ART.
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../pyart2baltrad/pyart_baltrad_dealias_example.html">
     Doppler Velocity Dealiasing with Py-ART and BALTRAD
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Becoming a developer
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../package-development/README.html">
   Developing Open Source Software Packages
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Theme by <a href="https://projectpythia.org">Project Pythia</a>.<br><br>

</div>

</div>

        

        <main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main"><div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/notebooks/wradlib/wradlib_data_quality.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/openradar/erad2022"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/openradar/erad2022/issues/new?title=Issue%20on%20page%20%2Fnotebooks/wradlib/wradlib_data_quality.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        <a class="edit-button" href="https://github.com/openradar/erad2022/edit/main/notebooks/wradlib/wradlib_data_quality.ipynb"><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Edit this page"><i class="fas fa-pencil-alt"></i>suggest edit</button></a>
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> On this page
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#overview">
   Overview
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#prerequisites">
   Prerequisites
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#imports">
   Imports
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#import-swiss-radar-data-from-cfradial1-volumes">
   Import Swiss Radar Data from CfRadial1 Volumes
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#clutter-detection-with-gabella">
   Clutter detection with Gabella
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#wrap-gabella-clutter-detection-in-xarray-apply-ufunc">
     Wrap Gabella Clutter detection in Xarray
     <code class="docutils literal notranslate">
      <span class="pre">
       apply_ufunc
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#calculate-clutter-map">
     Calculate clutter map
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#plot-reflectivities-clutter-and-cluttermap">
     Plot Reflectivities, Clutter and Cluttermap
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#srtm-based-clutter-and-beamblockage-processing">
   SRTM based clutter and beamblockage processing
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#download-needed-srtm-data">
     Download needed SRTM data
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#plot-clutter-on-dem">
     Plot Clutter on DEM
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#use-hvplot-for-interactive-zooming-and-panning">
     Use hvplot for interactive zooming and panning
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#convert-dem-to-spherical-coordinates">
     Convert DEM to spherical coordinates
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#partial-and-cumulative-beamblockage">
     Partial and Cumulative Beamblockage
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#plotting-beamblockage">
     Plotting Beamblockage
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#plotting-beamblockage-on-curvelinear-grid">
     Plotting Beamblockage on Curvelinear Grid
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#use-clutter-and-beamblockage-as-quality-index">
   Use Clutter and Beamblockage as Quality Index
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#summary">
   Summary
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#whats-next">
     What’s next?
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#resources-and-references">
   Resources and references
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
          <div id="main-content" class="row">
            <div class="col-12 col-md-9 pl-md-3 pr-md-0">
              
              <div>
                
  <p><a class="reference internal" href="../../_images/wradlib_logo.svg.png"><img alt="wradlib logo png" class="align-left" src="../../_images/wradlib_logo.svg.png" style="width: 250px;" /></a></img></p>
<div class="tex2jax_ignore mathjax_ignore section" id="wradlib-data-quality">
<h1>wradlib data quality<a class="headerlink" href="#wradlib-data-quality" title="Permalink to this headline"><i class="fas fa-link"></i></a></h1>
<hr class="docutils" />
<div class="section" id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline"><i class="fas fa-link"></i></a></h2>
<p>Within this notebook, we will cover:</p>
<ol class="arabic simple">
<li><p>Reading radar volume data into xarray based RadarVolume</p></li>
<li><p>Wrapping numpy-based functions to work with Xarray</p></li>
<li><p>Clutter detection</p></li>
<li><p>Beam Blockage calculation</p></li>
</ol>
</div>
<div class="section" id="prerequisites">
<h2>Prerequisites<a class="headerlink" href="#prerequisites" title="Permalink to this headline"><i class="fas fa-link"></i></a></h2>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Concepts</p></th>
<th class="head"><p>Importance</p></th>
<th class="head"><p>Notes</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference external" href="https://tutorial.xarray.dev/intro.html">Xarray Basics</a></p></td>
<td><p>Helpful</p></td>
<td><p>Basic Dataset/DataArray</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference external" href="https://foundations.projectpythia.org/core/matplotlib/matplotlib-basics.html">Matplotlib Basics</a></p></td>
<td><p>Helpful</p></td>
<td><p>Basic Plotting</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference external" href="https://foundations.projectpythia.org/core/cartopy/cartopy.html">Intro to Cartopy</a></p></td>
<td><p>Helpful</p></td>
<td><p>Projections</p></td>
</tr>
</tbody>
</table>
<ul class="simple">
<li><p><strong>Time to learn</strong>: 10 minutes</p></li>
</ul>
</div>
<hr class="docutils" />
<div class="section" id="imports">
<h2>Imports<a class="headerlink" href="#imports" title="Permalink to this headline"><i class="fas fa-link"></i></a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">glob</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="kn">import</span> <span class="nn">cartopy</span>
<span class="kn">import</span> <span class="nn">cartopy.crs</span> <span class="k">as</span> <span class="nn">ccrs</span>
<span class="kn">import</span> <span class="nn">cartopy.feature</span> <span class="k">as</span> <span class="nn">cfeature</span>
<span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>

<span class="kn">import</span> <span class="nn">wradlib</span> <span class="k">as</span> <span class="nn">wrl</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="import-swiss-radar-data-from-cfradial1-volumes">
<h2>Import Swiss Radar Data from CfRadial1 Volumes<a class="headerlink" href="#import-swiss-radar-data-from-cfradial1-volumes" title="Permalink to this headline"><i class="fas fa-link"></i></a></h2>
<p>We use some of the pyrad example data here. Sweeps are provided as single files, so we open each file separately and create the RadarVolume from the open Datasets.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fglob</span> <span class="o">=</span> <span class="s2">&quot;../pyart/data/example_pyrad/22179/MLL22179/MLL2217907250U*.nc&quot;</span>
<span class="n">flist</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">fglob</span><span class="p">)</span>
<span class="n">flist</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Files available: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">flist</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Files available: 20
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ds</span> <span class="o">=</span> <span class="p">[</span><span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">group</span><span class="o">=</span><span class="s2">&quot;sweep_1&quot;</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s2">&quot;cfradial1&quot;</span><span class="p">,</span> <span class="n">chunks</span><span class="o">=</span><span class="p">{})</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">flist</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/srv/conda/envs/notebook/lib/python3.9/site-packages/xarray/backends/plugins.py:43: RuntimeWarning: Found 2 entrypoints for the engine name cfradial1:
 [&#39;wradlib.io.backends&#39;, &#39;xradar.io.backends&#39;].
 The entrypoint wradlib.io.backends will be used.
  warnings.warn(
/srv/conda/envs/notebook/lib/python3.9/site-packages/xarray/backends/plugins.py:43: RuntimeWarning: Found 2 entrypoints for the engine name furuno:
 [&#39;xradar.io.backends&#39;, &#39;wradlib.io.backends&#39;].
 The entrypoint xradar.io.backends will be used.
  warnings.warn(
/srv/conda/envs/notebook/lib/python3.9/site-packages/xarray/backends/plugins.py:43: RuntimeWarning: Found 2 entrypoints for the engine name gamic:
 [&#39;xradar.io.backends&#39;, &#39;wradlib.io.backends&#39;].
 The entrypoint xradar.io.backends will be used.
  warnings.warn(
/srv/conda/envs/notebook/lib/python3.9/site-packages/xarray/backends/plugins.py:43: RuntimeWarning: Found 2 entrypoints for the engine name iris:
 [&#39;wradlib.io.backends&#39;, &#39;xradar.io.backends&#39;].
 The entrypoint wradlib.io.backends will be used.
  warnings.warn(
/srv/conda/envs/notebook/lib/python3.9/site-packages/xarray/backends/plugins.py:43: RuntimeWarning: Found 2 entrypoints for the engine name odim:
 [&#39;xradar.io.backends&#39;, &#39;wradlib.io.backends&#39;].
 The entrypoint xradar.io.backends will be used.
  warnings.warn(
/srv/conda/envs/notebook/lib/python3.9/site-packages/xarray/backends/plugins.py:43: RuntimeWarning: Found 2 entrypoints for the engine name rainbow:
 [&#39;xradar.io.backends&#39;, &#39;wradlib.io.backends&#39;].
 The entrypoint xradar.io.backends will be used.
  warnings.warn(
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vol</span> <span class="o">=</span> <span class="n">wrl</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">RadarVolume</span><span class="p">(</span><span class="n">engine</span><span class="o">=</span><span class="s2">&quot;cfradial1&quot;</span><span class="p">)</span>
<span class="n">vol</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">ds</span><span class="p">)</span>
<span class="n">vol</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">min</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">display</span><span class="p">(</span><span class="n">vol</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;wradlib.RadarVolume&gt;
Dimension(s): (sweep: 20)
Elevation(s): (2.5, 4.5, 6.5, -0.2, 1.0, 7.5, 8.5, 11.0, 16.0, 25.0, 35.0, 0.4, 1.6, 3.5, 5.5, 9.5, 13.0, 20.0, 30.0, 40.0)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vol</span><span class="o">.</span><span class="n">root</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:              (sweep: 20)
Coordinates:
    sweep_mode           &lt;U20 &#x27;azimuth_surveillance&#x27;
    longitude            float32 8.833
    altitude             float32 1.626e+03
    time                 datetime64[ns] 2022-06-28T07:19:28
    latitude             float32 46.04
Dimensions without coordinates: sweep
Data variables:
    volume_number        int64 0
    platform_type        &lt;U5 &#x27;fixed&#x27;
    instrument_type      &lt;U5 &#x27;radar&#x27;
    primary_axis         &lt;U6 &#x27;axis_z&#x27;
    time_coverage_start  &lt;U20 &#x27;2022-06-28T07:19:28Z&#x27;
    time_coverage_end    &lt;U20 &#x27;2022-06-28T07:23:44Z&#x27;
    sweep_group_name     (sweep) &lt;U8 &#x27;sweep_0&#x27; &#x27;sweep_1&#x27; ... &#x27;sweep_19&#x27;
    sweep_fixed_angle    (sweep) float32 2.5 4.5 6.5 -0.2 ... 20.0 30.0 40.0
Attributes:
    version:          None
    title:            None
    institution:      None
    references:       None
    source:           None
    history:          None
    comment:          im/exported using wradlib
    instrument_name:  None
    fixed_angle:      2.5</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-8f53a780-4c0a-4933-917c-03460b84ba05' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-8f53a780-4c0a-4933-917c-03460b84ba05' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span>sweep</span>: 20</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-04b29fbd-28ae-4823-990f-52b20fd8973b' class='xr-section-summary-in' type='checkbox'  checked><label for='section-04b29fbd-28ae-4823-990f-52b20fd8973b' class='xr-section-summary' >Coordinates: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>sweep_mode</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>&lt;U20</div><div class='xr-var-preview xr-preview'>&#x27;azimuth_surveillance&#x27;</div><input id='attrs-e6739cf4-d27a-4aeb-a7c9-6f9b504cd17d' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-e6739cf4-d27a-4aeb-a7c9-6f9b504cd17d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3caa358b-e2bd-45bb-9237-1ccd4fb2842a' class='xr-var-data-in' type='checkbox'><label for='data-3caa358b-e2bd-45bb-9237-1ccd4fb2842a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(&#x27;azimuth_surveillance&#x27;, dtype=&#x27;&lt;U20&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>longitude</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>8.833</div><input id='attrs-8bde9860-1dc3-40d9-8dec-e1648e5c16a0' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-8bde9860-1dc3-40d9-8dec-e1648e5c16a0' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-cfc6cd7a-d657-4888-9cf3-3286f4354355' class='xr-var-data-in' type='checkbox'><label for='data-cfc6cd7a-d657-4888-9cf3-3286f4354355' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>standard_name :</span></dt><dd>Longitude</dd></dl></div><div class='xr-var-data'><pre>array(8.833217, dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>altitude</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>1.626e+03</div><input id='attrs-1e42a653-7787-42cd-b26f-673925a21de8' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-1e42a653-7787-42cd-b26f-673925a21de8' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a48b1c04-eb5b-4201-a1f3-73116fff6cab' class='xr-var-data-in' type='checkbox'><label for='data-a48b1c04-eb5b-4201-a1f3-73116fff6cab' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Altitude</dd><dt><span>units :</span></dt><dd>meters</dd><dt><span>standard_name :</span></dt><dd>Altitude</dd><dt><span>positive :</span></dt><dd>up</dd></dl></div><div class='xr-var-data'><pre>array(1626., dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>time</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2022-06-28T07:19:28</div><input id='attrs-91f194c1-b8e5-4c08-b0c8-94c37a755861' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-91f194c1-b8e5-4c08-b0c8-94c37a755861' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e9f3b82c-4e1a-4da0-800f-c8d86ab76854' class='xr-var-data-in' type='checkbox'><label for='data-e9f3b82c-4e1a-4da0-800f-c8d86ab76854' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>time_in_seconds_since_volume_start</dd><dt><span>standard_name :</span></dt><dd>time</dd></dl></div><div class='xr-var-data'><pre>array(&#x27;2022-06-28T07:19:28.000000000&#x27;, dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>latitude</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>46.04</div><input id='attrs-5a8af1d2-acd3-4d74-84f4-fff88e28b702' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-5a8af1d2-acd3-4d74-84f4-fff88e28b702' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-8232458b-bd5c-4658-bc08-be9e5a67c299' class='xr-var-data-in' type='checkbox'><label for='data-8232458b-bd5c-4658-bc08-be9e5a67c299' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>standard_name :</span></dt><dd>Latitude</dd></dl></div><div class='xr-var-data'><pre>array(46.04076, dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-6dc08e16-9ffd-4a70-80a8-86c0e5d1f22e' class='xr-section-summary-in' type='checkbox'  checked><label for='section-6dc08e16-9ffd-4a70-80a8-86c0e5d1f22e' class='xr-section-summary' >Data variables: <span>(8)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>volume_number</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0</div><input id='attrs-23162bf7-89d7-4b2b-bad0-98dc9ca69a54' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-23162bf7-89d7-4b2b-bad0-98dc9ca69a54' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-160c9363-81e4-4938-aeeb-849f4e1bd12a' class='xr-var-data-in' type='checkbox'><label for='data-160c9363-81e4-4938-aeeb-849f4e1bd12a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(0)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>platform_type</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>&lt;U5</div><div class='xr-var-preview xr-preview'>&#x27;fixed&#x27;</div><input id='attrs-e95f1897-9004-4427-ac3e-d14ff3ea61f2' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-e95f1897-9004-4427-ac3e-d14ff3ea61f2' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9e571fde-9e8c-40fb-9f78-4fc70e0cce3d' class='xr-var-data-in' type='checkbox'><label for='data-9e571fde-9e8c-40fb-9f78-4fc70e0cce3d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(&#x27;fixed&#x27;, dtype=&#x27;&lt;U5&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>instrument_type</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>&lt;U5</div><div class='xr-var-preview xr-preview'>&#x27;radar&#x27;</div><input id='attrs-825a606f-c256-4488-a948-c7a9d7fc3d7f' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-825a606f-c256-4488-a948-c7a9d7fc3d7f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e6dbd8c4-af4a-4416-911f-56d7f2e03377' class='xr-var-data-in' type='checkbox'><label for='data-e6dbd8c4-af4a-4416-911f-56d7f2e03377' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(&#x27;radar&#x27;, dtype=&#x27;&lt;U5&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>primary_axis</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>&lt;U6</div><div class='xr-var-preview xr-preview'>&#x27;axis_z&#x27;</div><input id='attrs-13da1fb0-fda8-499c-a92f-894aecc90f8c' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-13da1fb0-fda8-499c-a92f-894aecc90f8c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-fe1d02ab-4284-4592-bce3-7f49751dcd8f' class='xr-var-data-in' type='checkbox'><label for='data-fe1d02ab-4284-4592-bce3-7f49751dcd8f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(&#x27;axis_z&#x27;, dtype=&#x27;&lt;U6&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>time_coverage_start</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>&lt;U20</div><div class='xr-var-preview xr-preview'>&#x27;2022-06-28T07:19:28Z&#x27;</div><input id='attrs-9f31e74a-cd3f-4a99-8512-3c41cb5a9488' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-9f31e74a-cd3f-4a99-8512-3c41cb5a9488' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-8d372149-a2ab-4595-9378-bcbc3b7dc6d0' class='xr-var-data-in' type='checkbox'><label for='data-8d372149-a2ab-4595-9378-bcbc3b7dc6d0' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(&#x27;2022-06-28T07:19:28Z&#x27;, dtype=&#x27;&lt;U20&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>time_coverage_end</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>&lt;U20</div><div class='xr-var-preview xr-preview'>&#x27;2022-06-28T07:23:44Z&#x27;</div><input id='attrs-c0bc1f17-2313-4111-a291-caa53b8f09f8' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-c0bc1f17-2313-4111-a291-caa53b8f09f8' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-56d9515d-219a-40bc-9cfc-9f68821513bc' class='xr-var-data-in' type='checkbox'><label for='data-56d9515d-219a-40bc-9cfc-9f68821513bc' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(&#x27;2022-06-28T07:23:44Z&#x27;, dtype=&#x27;&lt;U20&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>sweep_group_name</span></div><div class='xr-var-dims'>(sweep)</div><div class='xr-var-dtype'>&lt;U8</div><div class='xr-var-preview xr-preview'>&#x27;sweep_0&#x27; &#x27;sweep_1&#x27; ... &#x27;sweep_19&#x27;</div><input id='attrs-ac8a24bf-2c72-41df-99ad-f525e33b99b9' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-ac8a24bf-2c72-41df-99ad-f525e33b99b9' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-119010fc-cb16-472f-8e15-db225e7743a6' class='xr-var-data-in' type='checkbox'><label for='data-119010fc-cb16-472f-8e15-db225e7743a6' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;sweep_0&#x27;, &#x27;sweep_1&#x27;, &#x27;sweep_2&#x27;, &#x27;sweep_3&#x27;, &#x27;sweep_4&#x27;, &#x27;sweep_5&#x27;,
       &#x27;sweep_6&#x27;, &#x27;sweep_7&#x27;, &#x27;sweep_8&#x27;, &#x27;sweep_9&#x27;, &#x27;sweep_10&#x27;, &#x27;sweep_11&#x27;,
       &#x27;sweep_12&#x27;, &#x27;sweep_13&#x27;, &#x27;sweep_14&#x27;, &#x27;sweep_15&#x27;, &#x27;sweep_16&#x27;,
       &#x27;sweep_17&#x27;, &#x27;sweep_18&#x27;, &#x27;sweep_19&#x27;], dtype=&#x27;&lt;U8&#x27;)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>sweep_fixed_angle</span></div><div class='xr-var-dims'>(sweep)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>2.5 4.5 6.5 -0.2 ... 20.0 30.0 40.0</div><input id='attrs-72e089df-2a97-47ad-b167-f51c23a2ef26' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-72e089df-2a97-47ad-b167-f51c23a2ef26' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0bc640e7-21eb-4168-8385-6cc6e70e66f3' class='xr-var-data-in' type='checkbox'><label for='data-0bc640e7-21eb-4168-8385-6cc6e70e66f3' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ 2.5,  4.5,  6.5, -0.2,  1. ,  7.5,  8.5, 11. , 16. , 25. , 35. ,
        0.4,  1.6,  3.5,  5.5,  9.5, 13. , 20. , 30. , 40. ],
      dtype=float32)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-c61eff1f-c594-4bbf-8fb1-213dcd87c744' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-c61eff1f-c594-4bbf-8fb1-213dcd87c744' class='xr-section-summary'  title='Expand/collapse section'>Indexes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'></ul></div></li><li class='xr-section-item'><input id='section-5c404c29-9a13-4686-9265-3a5927ec66e1' class='xr-section-summary-in' type='checkbox'  checked><label for='section-5c404c29-9a13-4686-9265-3a5927ec66e1' class='xr-section-summary' >Attributes: <span>(9)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>version :</span></dt><dd>None</dd><dt><span>title :</span></dt><dd>None</dd><dt><span>institution :</span></dt><dd>None</dd><dt><span>references :</span></dt><dd>None</dd><dt><span>source :</span></dt><dd>None</dd><dt><span>history :</span></dt><dd>None</dd><dt><span>comment :</span></dt><dd>im/exported using wradlib</dd><dt><span>instrument_name :</span></dt><dd>None</dd><dt><span>fixed_angle :</span></dt><dd>2.5</dd></dl></div></li></ul></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sweep_number</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">display</span><span class="p">(</span><span class="n">vol</span><span class="p">[</span><span class="n">sweep_number</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:                              (azimuth: 360, range: 492, frequency: 1)
Coordinates:
    rtime                                (azimuth) datetime64[ns] dask.array&lt;chunksize=(360,), meta=np.ndarray&gt;
  * range                                (range) float32 250.0 ... 2.457e+05
  * azimuth                              (azimuth) float32 0.5246 ... 359.5
    elevation                            (azimuth) float32 dask.array&lt;chunksize=(360,), meta=np.ndarray&gt;
    sweep_mode                           &lt;U20 ...
  * frequency                            (frequency) float32 5.451e+09
    latitude                             float32 ...
    longitude                            float32 ...
    altitude                             float32 ...
    time                                 datetime64[ns] ...
Data variables: (12/20)
    reflectivity                         (azimuth, range) float32 dask.array&lt;chunksize=(360, 492), meta=np.ndarray&gt;
    signal_to_noise_ratio                (azimuth, range) float32 dask.array&lt;chunksize=(360, 492), meta=np.ndarray&gt;
    reflectivity_vv                      (azimuth, range) float32 dask.array&lt;chunksize=(360, 492), meta=np.ndarray&gt;
    differential_reflectivity            (azimuth, range) float32 dask.array&lt;chunksize=(360, 492), meta=np.ndarray&gt;
    uncorrected_cross_correlation_ratio  (azimuth, range) float32 dask.array&lt;chunksize=(360, 492), meta=np.ndarray&gt;
    uncorrected_differential_phase       (azimuth, range) float32 dask.array&lt;chunksize=(360, 492), meta=np.ndarray&gt;
    ...                                   ...
    radar_beam_width_v                   float32 ...
    pulse_width                          (azimuth) timedelta64[ns] dask.array&lt;chunksize=(360,), meta=np.ndarray&gt;
    nyquist_velocity                     (azimuth) float32 dask.array&lt;chunksize=(360,), meta=np.ndarray&gt;
    time_coverage_start                  |S32 ...
    time_coverage_end                    |S32 ...
    volume_number                        int32 ...
Attributes:
    fixed_angle:  -0.2</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-b7122722-d901-477d-a0e8-d8bff44c662e' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-b7122722-d901-477d-a0e8-d8bff44c662e' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>azimuth</span>: 360</li><li><span class='xr-has-index'>range</span>: 492</li><li><span class='xr-has-index'>frequency</span>: 1</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-d0c32c4a-cb5a-44bd-95dd-3c63c3e0f878' class='xr-section-summary-in' type='checkbox'  checked><label for='section-d0c32c4a-cb5a-44bd-95dd-3c63c3e0f878' class='xr-section-summary' >Coordinates: <span>(10)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>rtime</span></div><div class='xr-var-dims'>(azimuth)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(360,), meta=np.ndarray&gt;</div><input id='attrs-8ce297c7-0980-479e-8904-1c0a36f0638d' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-8ce297c7-0980-479e-8904-1c0a36f0638d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-999a44a1-96e8-416c-b1e5-64ceddc0efbc' class='xr-var-data-in' type='checkbox'><label for='data-999a44a1-96e8-416c-b1e5-64ceddc0efbc' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>time_in_seconds_since_volume_start</dd><dt><span>standard_name :</span></dt><dd>time</dd><dt><span>comment :</span></dt><dd>Coordinate variable for time. Time at the center of each ray, in fractional seconds since the global variable time_coverage_start</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 2.81 kiB </td>
                        <td> 2.81 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (360,) </td>
                        <td> (360,) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 2 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> datetime64[ns] numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="75" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >360</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">1</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>range</span></div><div class='xr-var-dims'>(range)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>250.0 750.0 ... 2.452e+05 2.457e+05</div><input id='attrs-cb1e1f98-dce0-4f86-b97b-449f5a284581' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-cb1e1f98-dce0-4f86-b97b-449f5a284581' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-948c7dc1-83ae-450e-b38d-555dc932a3b1' class='xr-var-data-in' type='checkbox'><label for='data-948c7dc1-83ae-450e-b38d-555dc932a3b1' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>range_to_measurement_volume</dd><dt><span>units :</span></dt><dd>meters</dd><dt><span>standard_name :</span></dt><dd>projection_range_coordinate</dd><dt><span>axis :</span></dt><dd>radial_range_coordinate</dd><dt><span>spacing_is_constant :</span></dt><dd>true</dd><dt><span>comment :</span></dt><dd>Coordinate variable for range. Range to center of each bin.</dd></dl></div><div class='xr-var-data'><pre>array([   249.99901,    749.997  ,   1249.995  , ..., 244749.02   ,
       245249.02   , 245749.02   ], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>azimuth</span></div><div class='xr-var-dims'>(azimuth)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.5246 1.527 2.524 ... 358.5 359.5</div><input id='attrs-b462b0ef-6c8a-4ae3-bc47-44566ab5a242' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-b462b0ef-6c8a-4ae3-bc47-44566ab5a242' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d50c2af5-c2f8-498c-91e6-3a0eacea2dd5' class='xr-var-data-in' type='checkbox'><label for='data-d50c2af5-c2f8-498c-91e6-3a0eacea2dd5' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>azimuth_angle_from_true_north</dd><dt><span>units :</span></dt><dd>degrees</dd><dt><span>standard_name :</span></dt><dd>beam_azimuth_angle</dd><dt><span>axis :</span></dt><dd>radial_azimuth_coordinate</dd><dt><span>comment :</span></dt><dd>Azimuth of antenna relative to true north</dd></dl></div><div class='xr-var-data'><pre>array([  0.524605,   1.527123,   2.524148, ..., 357.52805 , 358.5278  ,
       359.5276  ], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>elevation</span></div><div class='xr-var-dims'>(azimuth)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(360,), meta=np.ndarray&gt;</div><input id='attrs-6e1e55c4-210b-4929-b7cb-eb76fdfa5276' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-6e1e55c4-210b-4929-b7cb-eb76fdfa5276' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-98ee2d79-2c63-41fd-8c12-fdce3c242806' class='xr-var-data-in' type='checkbox'><label for='data-98ee2d79-2c63-41fd-8c12-fdce3c242806' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>elevation_angle_from_horizontal_plane</dd><dt><span>units :</span></dt><dd>degrees</dd><dt><span>standard_name :</span></dt><dd>beam_elevation_angle</dd><dt><span>axis :</span></dt><dd>radial_elevation_coordinate</dd><dt><span>comment :</span></dt><dd>Elevation of antenna relative to the horizontal plane</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 1.41 kiB </td>
                        <td> 1.41 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (360,) </td>
                        <td> (360,) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 2 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="75" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >360</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">1</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>sweep_mode</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>&lt;U20</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-cf6cf933-d4dc-46fe-8f15-7a7efd495ac9' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-cf6cf933-d4dc-46fe-8f15-7a7efd495ac9' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-118440ba-841c-48a4-9657-2476e600f62a' class='xr-var-data-in' type='checkbox'><label for='data-118440ba-841c-48a4-9657-2476e600f62a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>[1 values with dtype=&lt;U20]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>frequency</span></div><div class='xr-var-dims'>(frequency)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>5.451e+09</div><input id='attrs-ba559fef-3106-4288-a201-1ef016fb7ba9' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-ba559fef-3106-4288-a201-1ef016fb7ba9' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-dc776d1c-6611-48de-9eee-a9cb1f03c16e' class='xr-var-data-in' type='checkbox'><label for='data-dc776d1c-6611-48de-9eee-a9cb1f03c16e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Radiation frequency</dd><dt><span>units :</span></dt><dd>s-1</dd><dt><span>meta_group :</span></dt><dd>instrument_parameters</dd></dl></div><div class='xr-var-data'><pre>array([5.450772e+09], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>latitude</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-fc3a3b2b-6985-4eb5-8234-b948c2e93305' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-fc3a3b2b-6985-4eb5-8234-b948c2e93305' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-42725e87-f31b-4cf7-ac20-e530fd003b5b' class='xr-var-data-in' type='checkbox'><label for='data-42725e87-f31b-4cf7-ac20-e530fd003b5b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>standard_name :</span></dt><dd>Latitude</dd></dl></div><div class='xr-var-data'><pre>[1 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>longitude</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-11a6bd4e-fce7-4ff4-97c1-f679c779ee82' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-11a6bd4e-fce7-4ff4-97c1-f679c779ee82' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6a4fd94f-1fec-48a4-8ceb-9cad9dbbe815' class='xr-var-data-in' type='checkbox'><label for='data-6a4fd94f-1fec-48a4-8ceb-9cad9dbbe815' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>standard_name :</span></dt><dd>Longitude</dd></dl></div><div class='xr-var-data'><pre>[1 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>altitude</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-039f88e8-90e8-4d37-8fe5-f9823a1396d0' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-039f88e8-90e8-4d37-8fe5-f9823a1396d0' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-02a3c728-7c98-4265-a3b4-4f4ecef25ffc' class='xr-var-data-in' type='checkbox'><label for='data-02a3c728-7c98-4265-a3b4-4f4ecef25ffc' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Altitude</dd><dt><span>units :</span></dt><dd>meters</dd><dt><span>standard_name :</span></dt><dd>Altitude</dd><dt><span>positive :</span></dt><dd>up</dd></dl></div><div class='xr-var-data'><pre>[1 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>time</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-c11caf7e-b10c-4c40-8539-37f40a5d0e15' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-c11caf7e-b10c-4c40-8539-37f40a5d0e15' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b0084118-9169-42ae-82f8-925dfa59da06' class='xr-var-data-in' type='checkbox'><label for='data-b0084118-9169-42ae-82f8-925dfa59da06' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>time_in_seconds_since_volume_start</dd><dt><span>standard_name :</span></dt><dd>time</dd></dl></div><div class='xr-var-data'><pre>[1 values with dtype=datetime64[ns]]</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-c5ae1860-a01b-4f06-90a1-26335f8d2b5c' class='xr-section-summary-in' type='checkbox'  ><label for='section-c5ae1860-a01b-4f06-90a1-26335f8d2b5c' class='xr-section-summary' >Data variables: <span>(20)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>reflectivity</span></div><div class='xr-var-dims'>(azimuth, range)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(360, 492), meta=np.ndarray&gt;</div><input id='attrs-305a3520-0780-4e50-b57c-1e648e9778a1' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-305a3520-0780-4e50-b57c-1e648e9778a1' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-eebbceb4-6275-489b-a534-d12f3ca87ceb' class='xr-var-data-in' type='checkbox'><label for='data-eebbceb4-6275-489b-a534-d12f3ca87ceb' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Reflectivity</dd><dt><span>units :</span></dt><dd>dBZ</dd><dt><span>standard_name :</span></dt><dd>equivalent_reflectivity_factor</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 691.88 kiB </td>
                        <td> 691.88 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (360, 492) </td>
                        <td> (360, 492) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 2 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="137" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="87" x2="120" y2="87" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="87" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="87" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,87.80487804878048 0.0,87.80487804878048" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="107.804878" font-size="1.0rem" font-weight="100" text-anchor="middle" >492</text>
  <text x="140.000000" y="43.902439" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,140.000000,43.902439)">360</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>signal_to_noise_ratio</span></div><div class='xr-var-dims'>(azimuth, range)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(360, 492), meta=np.ndarray&gt;</div><input id='attrs-455e2b86-a5f8-4fbc-9ff6-f3d83bce8e89' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-455e2b86-a5f8-4fbc-9ff6-f3d83bce8e89' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e28a2b38-584d-481e-b73a-a775db321ba0' class='xr-var-data-in' type='checkbox'><label for='data-e28a2b38-584d-481e-b73a-a775db321ba0' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Signal to noise ratio</dd><dt><span>units :</span></dt><dd>dB</dd><dt><span>standard_name :</span></dt><dd>signal_to_noise_ratio</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 691.88 kiB </td>
                        <td> 691.88 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (360, 492) </td>
                        <td> (360, 492) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 2 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="137" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="87" x2="120" y2="87" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="87" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="87" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,87.80487804878048 0.0,87.80487804878048" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="107.804878" font-size="1.0rem" font-weight="100" text-anchor="middle" >492</text>
  <text x="140.000000" y="43.902439" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,140.000000,43.902439)">360</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>reflectivity_vv</span></div><div class='xr-var-dims'>(azimuth, range)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(360, 492), meta=np.ndarray&gt;</div><input id='attrs-ca1d1027-e1b5-49c0-91ab-bdb1c5cd1e88' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-ca1d1027-e1b5-49c0-91ab-bdb1c5cd1e88' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d5e48c68-7417-45b5-a610-a001be1fa1b9' class='xr-var-data-in' type='checkbox'><label for='data-d5e48c68-7417-45b5-a610-a001be1fa1b9' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 691.88 kiB </td>
                        <td> 691.88 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (360, 492) </td>
                        <td> (360, 492) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 2 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="137" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="87" x2="120" y2="87" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="87" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="87" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,87.80487804878048 0.0,87.80487804878048" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="107.804878" font-size="1.0rem" font-weight="100" text-anchor="middle" >492</text>
  <text x="140.000000" y="43.902439" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,140.000000,43.902439)">360</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>differential_reflectivity</span></div><div class='xr-var-dims'>(azimuth, range)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(360, 492), meta=np.ndarray&gt;</div><input id='attrs-115170c8-772f-4cac-a6f2-d1dea13ceb3e' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-115170c8-772f-4cac-a6f2-d1dea13ceb3e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-231b0da8-720a-4b55-a69a-0b9b94f64ac8' class='xr-var-data-in' type='checkbox'><label for='data-231b0da8-720a-4b55-a69a-0b9b94f64ac8' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Differential reflectivity</dd><dt><span>units :</span></dt><dd>dB</dd><dt><span>standard_name :</span></dt><dd>log_differential_reflectivity_hv</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 691.88 kiB </td>
                        <td> 691.88 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (360, 492) </td>
                        <td> (360, 492) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 2 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="137" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="87" x2="120" y2="87" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="87" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="87" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,87.80487804878048 0.0,87.80487804878048" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="107.804878" font-size="1.0rem" font-weight="100" text-anchor="middle" >492</text>
  <text x="140.000000" y="43.902439" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,140.000000,43.902439)">360</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>uncorrected_cross_correlation_ratio</span></div><div class='xr-var-dims'>(azimuth, range)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(360, 492), meta=np.ndarray&gt;</div><input id='attrs-e7d4d54f-6d6c-405b-b4e4-1e280a35498d' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-e7d4d54f-6d6c-405b-b4e4-1e280a35498d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d0fb7929-eff4-4cd1-b095-ba19275b63c4' class='xr-var-data-in' type='checkbox'><label for='data-d0fb7929-eff4-4cd1-b095-ba19275b63c4' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 691.88 kiB </td>
                        <td> 691.88 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (360, 492) </td>
                        <td> (360, 492) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 2 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="137" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="87" x2="120" y2="87" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="87" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="87" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,87.80487804878048 0.0,87.80487804878048" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="107.804878" font-size="1.0rem" font-weight="100" text-anchor="middle" >492</text>
  <text x="140.000000" y="43.902439" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,140.000000,43.902439)">360</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>uncorrected_differential_phase</span></div><div class='xr-var-dims'>(azimuth, range)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(360, 492), meta=np.ndarray&gt;</div><input id='attrs-8480a0b9-f658-42f1-a230-a5913c59849e' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-8480a0b9-f658-42f1-a230-a5913c59849e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-307d03c4-5b2f-4847-95ba-070d06e9a81b' class='xr-var-data-in' type='checkbox'><label for='data-307d03c4-5b2f-4847-95ba-070d06e9a81b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 691.88 kiB </td>
                        <td> 691.88 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (360, 492) </td>
                        <td> (360, 492) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 2 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="137" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="87" x2="120" y2="87" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="87" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="87" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,87.80487804878048 0.0,87.80487804878048" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="107.804878" font-size="1.0rem" font-weight="100" text-anchor="middle" >492</text>
  <text x="140.000000" y="43.902439" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,140.000000,43.902439)">360</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>velocity</span></div><div class='xr-var-dims'>(azimuth, range)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(360, 492), meta=np.ndarray&gt;</div><input id='attrs-c998423a-ef86-4843-943e-cef7289a8d85' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-c998423a-ef86-4843-943e-cef7289a8d85' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-202bec63-3b41-49f2-a090-e8d669809861' class='xr-var-data-in' type='checkbox'><label for='data-202bec63-3b41-49f2-a090-e8d669809861' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Mean dopper velocity</dd><dt><span>units :</span></dt><dd>meters_per_second</dd><dt><span>standard_name :</span></dt><dd>radial_velocity_of_scatterers_away_from_instrument</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 691.88 kiB </td>
                        <td> 691.88 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (360, 492) </td>
                        <td> (360, 492) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 2 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="137" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="87" x2="120" y2="87" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="87" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="87" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,87.80487804878048 0.0,87.80487804878048" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="107.804878" font-size="1.0rem" font-weight="100" text-anchor="middle" >492</text>
  <text x="140.000000" y="43.902439" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,140.000000,43.902439)">360</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>spectrum_width</span></div><div class='xr-var-dims'>(azimuth, range)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(360, 492), meta=np.ndarray&gt;</div><input id='attrs-65e1acce-7715-469a-ae76-b574de8c4dda' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-65e1acce-7715-469a-ae76-b574de8c4dda' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4bdf00fe-da35-456c-a39d-707f168558dc' class='xr-var-data-in' type='checkbox'><label for='data-4bdf00fe-da35-456c-a39d-707f168558dc' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Doppler spectrum width</dd><dt><span>units :</span></dt><dd>meters_per_second</dd><dt><span>standard_name :</span></dt><dd>doppler_spectrum_width</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 691.88 kiB </td>
                        <td> 691.88 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (360, 492) </td>
                        <td> (360, 492) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 2 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="137" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="87" x2="120" y2="87" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="87" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="87" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,87.80487804878048 0.0,87.80487804878048" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="107.804878" font-size="1.0rem" font-weight="100" text-anchor="middle" >492</text>
  <text x="140.000000" y="43.902439" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,140.000000,43.902439)">360</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>reflectivity_hh_clut</span></div><div class='xr-var-dims'>(azimuth, range)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(360, 492), meta=np.ndarray&gt;</div><input id='attrs-0c769db6-1371-4504-af0d-871c9f5ced2a' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-0c769db6-1371-4504-af0d-871c9f5ced2a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3b732828-4ec2-4a16-9962-6fc7dcbcf218' class='xr-var-data-in' type='checkbox'><label for='data-3b732828-4ec2-4a16-9962-6fc7dcbcf218' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 691.88 kiB </td>
                        <td> 691.88 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (360, 492) </td>
                        <td> (360, 492) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 2 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="137" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="87" x2="120" y2="87" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="87" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="87" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,87.80487804878048 0.0,87.80487804878048" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="107.804878" font-size="1.0rem" font-weight="100" text-anchor="middle" >492</text>
  <text x="140.000000" y="43.902439" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,140.000000,43.902439)">360</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>sweep_number</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-4393e0bc-73af-4620-843c-8f4b5ea50f82' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-4393e0bc-73af-4620-843c-8f4b5ea50f82' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9df93cbf-222f-4c3c-baa6-3858c45c2a4f' class='xr-var-data-in' type='checkbox'><label for='data-9df93cbf-222f-4c3c-baa6-3858c45c2a4f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Sweep number</dd><dt><span>units :</span></dt><dd>count</dd><dt><span>standard_name :</span></dt><dd>sweep_number</dd></dl></div><div class='xr-var-data'><pre>[1 values with dtype=int64]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>fixed_angle</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-d3996cfb-8400-4aa2-bbf4-d50a0e7d8871' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-d3996cfb-8400-4aa2-bbf4-d50a0e7d8871' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-bc13c8f8-dde2-4dbe-911e-3b1bec8c56eb' class='xr-var-data-in' type='checkbox'><label for='data-bc13c8f8-dde2-4dbe-911e-3b1bec8c56eb' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Target angle for sweep</dd><dt><span>units :</span></dt><dd>degrees</dd><dt><span>standard_name :</span></dt><dd>target_fixed_angle</dd></dl></div><div class='xr-var-data'><pre>[1 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>rays_are_indexed</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>|S32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-96a38daf-04c4-4beb-bf40-7f08a37d2091' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-96a38daf-04c4-4beb-bf40-7f08a37d2091' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6e1c3163-31f2-4a43-994f-6a738e9b217d' class='xr-var-data-in' type='checkbox'><label for='data-6e1c3163-31f2-4a43-994f-6a738e9b217d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Flag for indexed rays</dd><dt><span>units :</span></dt><dd>unitless</dd><dt><span>options :</span></dt><dd>true: rays are indexed to a regular grid, false: rays are not indexed to a regular grid</dd></dl></div><div class='xr-var-data'><pre>[1 values with dtype=|S32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>ray_angle_res</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-fddfdadf-1837-4bd0-ad0c-9bb2133c24f6' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-fddfdadf-1837-4bd0-ad0c-9bb2133c24f6' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-926267e0-c752-433b-ab9f-b86fa5f7e7a2' class='xr-var-data-in' type='checkbox'><label for='data-926267e0-c752-433b-ab9f-b86fa5f7e7a2' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Angular resolution between rays</dd><dt><span>units :</span></dt><dd>degrees</dd><dt><span>comment :</span></dt><dd>Only applicable when rays_are_indexed variable is true</dd></dl></div><div class='xr-var-data'><pre>[1 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>radar_beam_width_h</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-82d1d1d4-9ce3-441a-9ecf-f66de42b0aa3' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-82d1d1d4-9ce3-441a-9ecf-f66de42b0aa3' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-90a82e69-5200-44e2-82be-d478a910410a' class='xr-var-data-in' type='checkbox'><label for='data-90a82e69-5200-44e2-82be-d478a910410a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Antenna beam width H polarization</dd><dt><span>units :</span></dt><dd>degrees</dd><dt><span>meta_group :</span></dt><dd>radar_parameters</dd></dl></div><div class='xr-var-data'><pre>[1 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>radar_beam_width_v</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-4daa9190-c7c1-455f-9f60-6290f34601bd' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-4daa9190-c7c1-455f-9f60-6290f34601bd' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0f38aec4-c084-4f71-b9a3-5432a0a202de' class='xr-var-data-in' type='checkbox'><label for='data-0f38aec4-c084-4f71-b9a3-5432a0a202de' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Antenna beam width V polarization</dd><dt><span>units :</span></dt><dd>degrees</dd><dt><span>meta_group :</span></dt><dd>radar_parameters</dd></dl></div><div class='xr-var-data'><pre>[1 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>pulse_width</span></div><div class='xr-var-dims'>(azimuth)</div><div class='xr-var-dtype'>timedelta64[ns]</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(360,), meta=np.ndarray&gt;</div><input id='attrs-235d7129-3e98-4156-9d02-422d891b332a' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-235d7129-3e98-4156-9d02-422d891b332a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e7edf6c5-e6f8-4f39-af57-9c0c5c82fd3a' class='xr-var-data-in' type='checkbox'><label for='data-e7edf6c5-e6f8-4f39-af57-9c0c5c82fd3a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Pulse width</dd><dt><span>comments :</span></dt><dd>Pulse width</dd><dt><span>meta_group :</span></dt><dd>instrument_parameters</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 2.81 kiB </td>
                        <td> 2.81 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (360,) </td>
                        <td> (360,) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 2 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> timedelta64[ns] numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="75" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >360</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">1</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>nyquist_velocity</span></div><div class='xr-var-dims'>(azimuth)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(360,), meta=np.ndarray&gt;</div><input id='attrs-bddea824-8c38-42d3-b920-6130f7fc7cb3' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-bddea824-8c38-42d3-b920-6130f7fc7cb3' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4f301a07-11b0-4b3c-aec5-f3ee158e49a7' class='xr-var-data-in' type='checkbox'><label for='data-4f301a07-11b0-4b3c-aec5-f3ee158e49a7' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Nyquist velocity</dd><dt><span>units :</span></dt><dd>meters_per_second</dd><dt><span>comments :</span></dt><dd>Unambiguous velocity</dd><dt><span>meta_group :</span></dt><dd>instrument_parameters</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 1.41 kiB </td>
                        <td> 1.41 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (360,) </td>
                        <td> (360,) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 2 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="75" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >360</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">1</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>time_coverage_start</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>|S32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-38e97ee2-0f46-4a03-b1e7-6f762f7984d0' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-38e97ee2-0f46-4a03-b1e7-6f762f7984d0' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-138f6e35-3a1f-49ca-b50c-ff534c4188a0' class='xr-var-data-in' type='checkbox'><label for='data-138f6e35-3a1f-49ca-b50c-ff534c4188a0' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>UTC time of first ray in the file</dd><dt><span>units :</span></dt><dd>unitless</dd></dl></div><div class='xr-var-data'><pre>[1 values with dtype=|S32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>time_coverage_end</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>|S32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-78a3f408-840f-4702-89cd-8b2e3849e398' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-78a3f408-840f-4702-89cd-8b2e3849e398' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f396357e-10f1-4b3e-b6b8-1020d2d7cd2d' class='xr-var-data-in' type='checkbox'><label for='data-f396357e-10f1-4b3e-b6b8-1020d2d7cd2d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>UTC time of last ray in the file</dd><dt><span>units :</span></dt><dd>unitless</dd></dl></div><div class='xr-var-data'><pre>[1 values with dtype=|S32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>volume_number</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-f85199ee-d092-4c7d-a2ae-0cbd98f17217' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-f85199ee-d092-4c7d-a2ae-0cbd98f17217' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b06a0f4a-cf0a-4b03-9b81-8416301e6a5e' class='xr-var-data-in' type='checkbox'><label for='data-b06a0f4a-cf0a-4b03-9b81-8416301e6a5e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Volume number</dd><dt><span>units :</span></dt><dd>unitless</dd></dl></div><div class='xr-var-data'><pre>[1 values with dtype=int32]</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-950ac9b9-d996-4128-a97b-e9b9f0d51ddf' class='xr-section-summary-in' type='checkbox'  ><label for='section-950ac9b9-d996-4128-a97b-e9b9f0d51ddf' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>range</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-d22b19ba-9cba-4514-950d-63c96356bfa9' class='xr-index-data-in' type='checkbox'/><label for='index-d22b19ba-9cba-4514-950d-63c96356bfa9' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([249.99900817871094,  749.9970092773438, 1249.9949951171875,
       1749.9930419921875,  2249.990966796875,  2749.989013671875,
        3249.987060546875,  3749.985107421875,   4249.98291015625,
         4749.98095703125,
       ...
             241249.03125,       241749.03125,       242249.03125,
             242749.03125,       243249.03125,       243749.03125,
             244249.03125,      244749.015625,      245249.015625,
            245749.015625],
      dtype=&#x27;float32&#x27;, name=&#x27;range&#x27;, length=492))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>azimuth</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-50340fab-9c45-41a4-bd76-d0f0970bbed8' class='xr-index-data-in' type='checkbox'/><label for='index-50340fab-9c45-41a4-bd76-d0f0970bbed8' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([0.5246051549911499, 1.5271228551864624, 2.5241475105285645,
        3.526665210723877, 4.5374226570129395,  5.534447193145752,
       6.5232319831848145,  7.525749683380127,  8.536507606506348,
         9.54177188873291,
       ...
        350.5296325683594, 351.53765869140625,   352.545654296875,
        353.5372009277344,  354.5342102050781, 355.54498291015625,
       356.53924560546875,  357.5280456542969,  358.5278015136719,
         359.527587890625],
      dtype=&#x27;float32&#x27;, name=&#x27;azimuth&#x27;, length=360))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>frequency</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-fe5c9fb0-fb57-4f1e-a15e-98b79b7648ea' class='xr-index-data-in' type='checkbox'/><label for='index-fe5c9fb0-fb57-4f1e-a15e-98b79b7648ea' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([5450772000.0], dtype=&#x27;float32&#x27;, name=&#x27;frequency&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-8148eb35-f48e-4986-914f-b2fc2116fb04' class='xr-section-summary-in' type='checkbox'  checked><label for='section-8148eb35-f48e-4986-914f-b2fc2116fb04' class='xr-section-summary' >Attributes: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>fixed_angle :</span></dt><dd>-0.2</dd></dl></div></li></ul></div></div></div></div>
</div>
</div>
<div class="section" id="clutter-detection-with-gabella">
<h2>Clutter detection with Gabella<a class="headerlink" href="#clutter-detection-with-gabella" title="Permalink to this headline"><i class="fas fa-link"></i></a></h2>
<p>While in Switzerland, why not use the well-known clutter detection scheme by Marco Gabella et. al.</p>
<div class="section" id="wrap-gabella-clutter-detection-in-xarray-apply-ufunc">
<h3>Wrap Gabella Clutter detection in Xarray <code class="docutils literal notranslate"><span class="pre">apply_ufunc</span></code><a class="headerlink" href="#wrap-gabella-clutter-detection-in-xarray-apply-ufunc" title="Permalink to this headline"><i class="fas fa-link"></i></a></h3>
<p>The routine is implemented in wradlib in pure <code class="docutils literal notranslate"><span class="pre">Numpy</span></code>. <code class="docutils literal notranslate"><span class="pre">Numpy</span></code> based processing routines can be transformed to a first class <code class="docutils literal notranslate"><span class="pre">Xarray</span></code> citizen with the help of <code class="docutils literal notranslate"><span class="pre">xr.apply_ufunc</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">extract_clutter</span><span class="p">(</span><span class="n">da</span><span class="p">,</span> <span class="n">wsize</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">thrsnorain</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">tr1</span><span class="o">=</span><span class="mf">6.0</span><span class="p">,</span> <span class="n">n_p</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">tr2</span><span class="o">=</span><span class="mf">1.3</span><span class="p">,</span> <span class="n">rm_nans</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">xr</span><span class="o">.</span><span class="n">apply_ufunc</span><span class="p">(</span>
        <span class="n">wrl</span><span class="o">.</span><span class="n">clutter</span><span class="o">.</span><span class="n">filter_gabella</span><span class="p">,</span>
        <span class="n">da</span><span class="p">,</span>
        <span class="n">input_core_dims</span><span class="o">=</span><span class="p">[[</span><span class="s2">&quot;azimuth&quot;</span><span class="p">,</span> <span class="s2">&quot;range&quot;</span><span class="p">]],</span>
        <span class="n">output_core_dims</span><span class="o">=</span><span class="p">[[</span><span class="s2">&quot;azimuth&quot;</span><span class="p">,</span> <span class="s2">&quot;range&quot;</span><span class="p">]],</span>
        <span class="n">dask</span><span class="o">=</span><span class="s2">&quot;parallelized&quot;</span><span class="p">,</span>
        <span class="n">kwargs</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
            <span class="n">wsize</span><span class="o">=</span><span class="n">wsize</span><span class="p">,</span>
            <span class="n">thrsnorain</span><span class="o">=</span><span class="n">thrsnorain</span><span class="p">,</span>
            <span class="n">tr1</span><span class="o">=</span><span class="n">tr1</span><span class="p">,</span>
            <span class="n">n_p</span><span class="o">=</span><span class="n">n_p</span><span class="p">,</span>
            <span class="n">tr2</span><span class="o">=</span><span class="n">tr2</span><span class="p">,</span>
            <span class="n">rm_nans</span><span class="o">=</span><span class="n">rm_nans</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="calculate-clutter-map">
<h3>Calculate clutter map<a class="headerlink" href="#calculate-clutter-map" title="Permalink to this headline"><i class="fas fa-link"></i></a></h3>
<p>Now we apply Gabella scheme and add the result to the Dataset.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">swp</span> <span class="o">=</span> <span class="n">vol</span><span class="p">[</span><span class="n">sweep_number</span><span class="p">]</span>
<span class="n">clmap</span> <span class="o">=</span> <span class="n">swp</span><span class="o">.</span><span class="n">reflectivity_hh_clut</span><span class="o">.</span><span class="n">pipe</span><span class="p">(</span>
    <span class="n">extract_clutter</span><span class="p">,</span> <span class="n">wsize</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">thrsnorain</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">tr1</span><span class="o">=</span><span class="mf">21.0</span><span class="p">,</span> <span class="n">n_p</span><span class="o">=</span><span class="mi">23</span><span class="p">,</span> <span class="n">tr2</span><span class="o">=</span><span class="mf">1.3</span><span class="p">,</span> <span class="n">rm_nans</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>
<span class="n">swp</span> <span class="o">=</span> <span class="n">swp</span><span class="o">.</span><span class="n">assign</span><span class="p">({</span><span class="s2">&quot;CMAP&quot;</span><span class="p">:</span> <span class="n">clmap</span><span class="p">})</span>
<span class="n">display</span><span class="p">(</span><span class="n">swp</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:                              (azimuth: 360, range: 492, frequency: 1)
Coordinates:
    rtime                                (azimuth) datetime64[ns] dask.array&lt;chunksize=(360,), meta=np.ndarray&gt;
  * range                                (range) float32 250.0 ... 2.457e+05
  * azimuth                              (azimuth) float32 0.5246 ... 359.5
    elevation                            (azimuth) float32 dask.array&lt;chunksize=(360,), meta=np.ndarray&gt;
    sweep_mode                           &lt;U20 ...
  * frequency                            (frequency) float32 5.451e+09
    latitude                             float32 ...
    longitude                            float32 ...
    altitude                             float32 ...
    time                                 datetime64[ns] ...
Data variables: (12/21)
    reflectivity                         (azimuth, range) float32 dask.array&lt;chunksize=(360, 492), meta=np.ndarray&gt;
    signal_to_noise_ratio                (azimuth, range) float32 dask.array&lt;chunksize=(360, 492), meta=np.ndarray&gt;
    reflectivity_vv                      (azimuth, range) float32 dask.array&lt;chunksize=(360, 492), meta=np.ndarray&gt;
    differential_reflectivity            (azimuth, range) float32 dask.array&lt;chunksize=(360, 492), meta=np.ndarray&gt;
    uncorrected_cross_correlation_ratio  (azimuth, range) float32 dask.array&lt;chunksize=(360, 492), meta=np.ndarray&gt;
    uncorrected_differential_phase       (azimuth, range) float32 dask.array&lt;chunksize=(360, 492), meta=np.ndarray&gt;
    ...                                   ...
    pulse_width                          (azimuth) timedelta64[ns] dask.array&lt;chunksize=(360,), meta=np.ndarray&gt;
    nyquist_velocity                     (azimuth) float32 dask.array&lt;chunksize=(360,), meta=np.ndarray&gt;
    time_coverage_start                  |S32 ...
    time_coverage_end                    |S32 ...
    volume_number                        int32 ...
    CMAP                                 (azimuth, range) bool dask.array&lt;chunksize=(360, 492), meta=np.ndarray&gt;
Attributes:
    fixed_angle:  -0.2</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-7d5e0bac-0c4d-460f-8e54-fc056c4734dc' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-7d5e0bac-0c4d-460f-8e54-fc056c4734dc' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>azimuth</span>: 360</li><li><span class='xr-has-index'>range</span>: 492</li><li><span class='xr-has-index'>frequency</span>: 1</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-72b0923c-f03b-4feb-982f-0ae3c99c53f8' class='xr-section-summary-in' type='checkbox'  checked><label for='section-72b0923c-f03b-4feb-982f-0ae3c99c53f8' class='xr-section-summary' >Coordinates: <span>(10)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>rtime</span></div><div class='xr-var-dims'>(azimuth)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(360,), meta=np.ndarray&gt;</div><input id='attrs-e7e67d55-55df-4afa-9d1f-2973d6d4c890' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-e7e67d55-55df-4afa-9d1f-2973d6d4c890' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e1429b5c-c6b6-4ee8-9e17-54ddf27c9a82' class='xr-var-data-in' type='checkbox'><label for='data-e1429b5c-c6b6-4ee8-9e17-54ddf27c9a82' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>time_in_seconds_since_volume_start</dd><dt><span>standard_name :</span></dt><dd>time</dd><dt><span>comment :</span></dt><dd>Coordinate variable for time. Time at the center of each ray, in fractional seconds since the global variable time_coverage_start</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 2.81 kiB </td>
                        <td> 2.81 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (360,) </td>
                        <td> (360,) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 2 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> datetime64[ns] numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="75" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >360</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">1</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>range</span></div><div class='xr-var-dims'>(range)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>250.0 750.0 ... 2.452e+05 2.457e+05</div><input id='attrs-c86a92b8-1b3f-402c-bd1d-aaf9f9a7dfeb' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-c86a92b8-1b3f-402c-bd1d-aaf9f9a7dfeb' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-fd1d429a-d33e-4cab-a792-e05d426d1994' class='xr-var-data-in' type='checkbox'><label for='data-fd1d429a-d33e-4cab-a792-e05d426d1994' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>range_to_measurement_volume</dd><dt><span>units :</span></dt><dd>meters</dd><dt><span>standard_name :</span></dt><dd>projection_range_coordinate</dd><dt><span>axis :</span></dt><dd>radial_range_coordinate</dd><dt><span>spacing_is_constant :</span></dt><dd>true</dd><dt><span>comment :</span></dt><dd>Coordinate variable for range. Range to center of each bin.</dd></dl></div><div class='xr-var-data'><pre>array([   249.99901,    749.997  ,   1249.995  , ..., 244749.02   ,
       245249.02   , 245749.02   ], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>azimuth</span></div><div class='xr-var-dims'>(azimuth)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>0.5246 1.527 2.524 ... 358.5 359.5</div><input id='attrs-3f04e1c4-41c2-46c0-bc7f-8d73a199220f' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-3f04e1c4-41c2-46c0-bc7f-8d73a199220f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d737613c-a475-4551-bf82-3a233539afe6' class='xr-var-data-in' type='checkbox'><label for='data-d737613c-a475-4551-bf82-3a233539afe6' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>azimuth_angle_from_true_north</dd><dt><span>units :</span></dt><dd>degrees</dd><dt><span>standard_name :</span></dt><dd>beam_azimuth_angle</dd><dt><span>axis :</span></dt><dd>radial_azimuth_coordinate</dd><dt><span>comment :</span></dt><dd>Azimuth of antenna relative to true north</dd></dl></div><div class='xr-var-data'><pre>array([  0.524605,   1.527123,   2.524148, ..., 357.52805 , 358.5278  ,
       359.5276  ], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>elevation</span></div><div class='xr-var-dims'>(azimuth)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(360,), meta=np.ndarray&gt;</div><input id='attrs-09d7ce8a-0767-4b7f-8c9b-6e057e83a332' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-09d7ce8a-0767-4b7f-8c9b-6e057e83a332' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-00a421ec-f15d-42c5-ac82-109cd41e3848' class='xr-var-data-in' type='checkbox'><label for='data-00a421ec-f15d-42c5-ac82-109cd41e3848' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>elevation_angle_from_horizontal_plane</dd><dt><span>units :</span></dt><dd>degrees</dd><dt><span>standard_name :</span></dt><dd>beam_elevation_angle</dd><dt><span>axis :</span></dt><dd>radial_elevation_coordinate</dd><dt><span>comment :</span></dt><dd>Elevation of antenna relative to the horizontal plane</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 1.41 kiB </td>
                        <td> 1.41 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (360,) </td>
                        <td> (360,) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 2 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="75" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >360</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">1</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>sweep_mode</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>&lt;U20</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-8cecf704-f5cc-4767-b412-db32fb583d3f' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-8cecf704-f5cc-4767-b412-db32fb583d3f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-7fa90bd1-7536-43e1-9ccf-d855625ecee6' class='xr-var-data-in' type='checkbox'><label for='data-7fa90bd1-7536-43e1-9ccf-d855625ecee6' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>[1 values with dtype=&lt;U20]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>frequency</span></div><div class='xr-var-dims'>(frequency)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>5.451e+09</div><input id='attrs-bfb20973-c1b6-43d8-966b-92c294e53187' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-bfb20973-c1b6-43d8-966b-92c294e53187' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-eed4608b-a38e-4dba-bfbd-3a8c4aa3eb43' class='xr-var-data-in' type='checkbox'><label for='data-eed4608b-a38e-4dba-bfbd-3a8c4aa3eb43' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Radiation frequency</dd><dt><span>units :</span></dt><dd>s-1</dd><dt><span>meta_group :</span></dt><dd>instrument_parameters</dd></dl></div><div class='xr-var-data'><pre>array([5.450772e+09], dtype=float32)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>latitude</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-bc756b20-0dce-41f6-b56e-255301d6d94d' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-bc756b20-0dce-41f6-b56e-255301d6d94d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1e0a757d-8a84-4139-9870-c9413490000c' class='xr-var-data-in' type='checkbox'><label for='data-1e0a757d-8a84-4139-9870-c9413490000c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd><dt><span>standard_name :</span></dt><dd>Latitude</dd></dl></div><div class='xr-var-data'><pre>[1 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>longitude</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-4c6679cc-6490-4910-8e9d-611ee2b17c0c' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-4c6679cc-6490-4910-8e9d-611ee2b17c0c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2b45a29f-584a-4834-b8f7-5cc03ff4fc91' class='xr-var-data-in' type='checkbox'><label for='data-2b45a29f-584a-4834-b8f7-5cc03ff4fc91' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd><dt><span>standard_name :</span></dt><dd>Longitude</dd></dl></div><div class='xr-var-data'><pre>[1 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>altitude</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-41525c4f-9b36-4f58-916f-0098b9bfd108' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-41525c4f-9b36-4f58-916f-0098b9bfd108' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f7c15740-2ee6-4cdc-b356-d0c697d3c47a' class='xr-var-data-in' type='checkbox'><label for='data-f7c15740-2ee6-4cdc-b356-d0c697d3c47a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Altitude</dd><dt><span>units :</span></dt><dd>meters</dd><dt><span>standard_name :</span></dt><dd>Altitude</dd><dt><span>positive :</span></dt><dd>up</dd></dl></div><div class='xr-var-data'><pre>[1 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>time</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-ff9c096d-6fb8-4a2b-94ac-a00bb1dd7800' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-ff9c096d-6fb8-4a2b-94ac-a00bb1dd7800' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-34b05ade-6991-49a1-9402-d53f464ba53f' class='xr-var-data-in' type='checkbox'><label for='data-34b05ade-6991-49a1-9402-d53f464ba53f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>time_in_seconds_since_volume_start</dd><dt><span>standard_name :</span></dt><dd>time</dd></dl></div><div class='xr-var-data'><pre>[1 values with dtype=datetime64[ns]]</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-b8f83ed2-e52f-4d41-b629-a9ebda7a7be1' class='xr-section-summary-in' type='checkbox'  ><label for='section-b8f83ed2-e52f-4d41-b629-a9ebda7a7be1' class='xr-section-summary' >Data variables: <span>(21)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>reflectivity</span></div><div class='xr-var-dims'>(azimuth, range)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(360, 492), meta=np.ndarray&gt;</div><input id='attrs-bde019f5-8f05-45ae-9432-685b50625276' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-bde019f5-8f05-45ae-9432-685b50625276' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2ebab4c9-8a14-453b-833a-6756f17a522c' class='xr-var-data-in' type='checkbox'><label for='data-2ebab4c9-8a14-453b-833a-6756f17a522c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Reflectivity</dd><dt><span>units :</span></dt><dd>dBZ</dd><dt><span>standard_name :</span></dt><dd>equivalent_reflectivity_factor</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 691.88 kiB </td>
                        <td> 691.88 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (360, 492) </td>
                        <td> (360, 492) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 2 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="137" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="87" x2="120" y2="87" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="87" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="87" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,87.80487804878048 0.0,87.80487804878048" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="107.804878" font-size="1.0rem" font-weight="100" text-anchor="middle" >492</text>
  <text x="140.000000" y="43.902439" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,140.000000,43.902439)">360</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>signal_to_noise_ratio</span></div><div class='xr-var-dims'>(azimuth, range)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(360, 492), meta=np.ndarray&gt;</div><input id='attrs-606e1501-7611-4e60-bdf9-44e40baf46fa' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-606e1501-7611-4e60-bdf9-44e40baf46fa' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-daeeacc0-1e18-405f-a6ff-ad95c95631aa' class='xr-var-data-in' type='checkbox'><label for='data-daeeacc0-1e18-405f-a6ff-ad95c95631aa' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Signal to noise ratio</dd><dt><span>units :</span></dt><dd>dB</dd><dt><span>standard_name :</span></dt><dd>signal_to_noise_ratio</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 691.88 kiB </td>
                        <td> 691.88 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (360, 492) </td>
                        <td> (360, 492) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 2 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="137" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="87" x2="120" y2="87" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="87" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="87" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,87.80487804878048 0.0,87.80487804878048" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="107.804878" font-size="1.0rem" font-weight="100" text-anchor="middle" >492</text>
  <text x="140.000000" y="43.902439" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,140.000000,43.902439)">360</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>reflectivity_vv</span></div><div class='xr-var-dims'>(azimuth, range)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(360, 492), meta=np.ndarray&gt;</div><input id='attrs-9f0f9330-1718-4b8e-9f96-bc472816a989' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-9f0f9330-1718-4b8e-9f96-bc472816a989' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6bd8adb9-0123-4a16-b0f9-f8c8fc2ff33b' class='xr-var-data-in' type='checkbox'><label for='data-6bd8adb9-0123-4a16-b0f9-f8c8fc2ff33b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 691.88 kiB </td>
                        <td> 691.88 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (360, 492) </td>
                        <td> (360, 492) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 2 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="137" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="87" x2="120" y2="87" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="87" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="87" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,87.80487804878048 0.0,87.80487804878048" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="107.804878" font-size="1.0rem" font-weight="100" text-anchor="middle" >492</text>
  <text x="140.000000" y="43.902439" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,140.000000,43.902439)">360</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>differential_reflectivity</span></div><div class='xr-var-dims'>(azimuth, range)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(360, 492), meta=np.ndarray&gt;</div><input id='attrs-a4255142-b783-4c4f-972e-d8f554896994' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-a4255142-b783-4c4f-972e-d8f554896994' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-bd2abbd4-9b7b-4097-af2c-f80040f03a23' class='xr-var-data-in' type='checkbox'><label for='data-bd2abbd4-9b7b-4097-af2c-f80040f03a23' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Differential reflectivity</dd><dt><span>units :</span></dt><dd>dB</dd><dt><span>standard_name :</span></dt><dd>log_differential_reflectivity_hv</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 691.88 kiB </td>
                        <td> 691.88 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (360, 492) </td>
                        <td> (360, 492) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 2 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="137" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="87" x2="120" y2="87" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="87" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="87" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,87.80487804878048 0.0,87.80487804878048" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="107.804878" font-size="1.0rem" font-weight="100" text-anchor="middle" >492</text>
  <text x="140.000000" y="43.902439" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,140.000000,43.902439)">360</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>uncorrected_cross_correlation_ratio</span></div><div class='xr-var-dims'>(azimuth, range)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(360, 492), meta=np.ndarray&gt;</div><input id='attrs-a33af9b2-9291-4c23-a386-9f31a765d351' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-a33af9b2-9291-4c23-a386-9f31a765d351' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e2bdbf64-537b-49e6-9e4c-8112acd088c1' class='xr-var-data-in' type='checkbox'><label for='data-e2bdbf64-537b-49e6-9e4c-8112acd088c1' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 691.88 kiB </td>
                        <td> 691.88 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (360, 492) </td>
                        <td> (360, 492) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 2 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="137" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="87" x2="120" y2="87" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="87" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="87" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,87.80487804878048 0.0,87.80487804878048" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="107.804878" font-size="1.0rem" font-weight="100" text-anchor="middle" >492</text>
  <text x="140.000000" y="43.902439" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,140.000000,43.902439)">360</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>uncorrected_differential_phase</span></div><div class='xr-var-dims'>(azimuth, range)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(360, 492), meta=np.ndarray&gt;</div><input id='attrs-ef270a8a-d798-40cb-86fd-ff0ada80001e' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-ef270a8a-d798-40cb-86fd-ff0ada80001e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-eebbc4ad-64d0-4014-9e4c-6bf466f8fa9c' class='xr-var-data-in' type='checkbox'><label for='data-eebbc4ad-64d0-4014-9e4c-6bf466f8fa9c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 691.88 kiB </td>
                        <td> 691.88 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (360, 492) </td>
                        <td> (360, 492) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 2 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="137" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="87" x2="120" y2="87" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="87" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="87" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,87.80487804878048 0.0,87.80487804878048" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="107.804878" font-size="1.0rem" font-weight="100" text-anchor="middle" >492</text>
  <text x="140.000000" y="43.902439" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,140.000000,43.902439)">360</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>velocity</span></div><div class='xr-var-dims'>(azimuth, range)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(360, 492), meta=np.ndarray&gt;</div><input id='attrs-cb92fc25-620f-4edc-9f7f-5f548bb2b92e' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-cb92fc25-620f-4edc-9f7f-5f548bb2b92e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0f691fb3-52b9-4dd8-922d-e7ce3f635a77' class='xr-var-data-in' type='checkbox'><label for='data-0f691fb3-52b9-4dd8-922d-e7ce3f635a77' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Mean dopper velocity</dd><dt><span>units :</span></dt><dd>meters_per_second</dd><dt><span>standard_name :</span></dt><dd>radial_velocity_of_scatterers_away_from_instrument</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 691.88 kiB </td>
                        <td> 691.88 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (360, 492) </td>
                        <td> (360, 492) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 2 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="137" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="87" x2="120" y2="87" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="87" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="87" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,87.80487804878048 0.0,87.80487804878048" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="107.804878" font-size="1.0rem" font-weight="100" text-anchor="middle" >492</text>
  <text x="140.000000" y="43.902439" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,140.000000,43.902439)">360</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>spectrum_width</span></div><div class='xr-var-dims'>(azimuth, range)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(360, 492), meta=np.ndarray&gt;</div><input id='attrs-4f181c81-4e71-4477-b6e2-394ac6a2c00b' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-4f181c81-4e71-4477-b6e2-394ac6a2c00b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6c472fc6-1c77-4fa4-ad58-8857b6d04b85' class='xr-var-data-in' type='checkbox'><label for='data-6c472fc6-1c77-4fa4-ad58-8857b6d04b85' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Doppler spectrum width</dd><dt><span>units :</span></dt><dd>meters_per_second</dd><dt><span>standard_name :</span></dt><dd>doppler_spectrum_width</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 691.88 kiB </td>
                        <td> 691.88 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (360, 492) </td>
                        <td> (360, 492) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 2 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="137" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="87" x2="120" y2="87" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="87" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="87" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,87.80487804878048 0.0,87.80487804878048" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="107.804878" font-size="1.0rem" font-weight="100" text-anchor="middle" >492</text>
  <text x="140.000000" y="43.902439" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,140.000000,43.902439)">360</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>reflectivity_hh_clut</span></div><div class='xr-var-dims'>(azimuth, range)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(360, 492), meta=np.ndarray&gt;</div><input id='attrs-c0453e69-aed0-4f0a-81ab-f13b1e301f44' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-c0453e69-aed0-4f0a-81ab-f13b1e301f44' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-85e862a4-a339-4836-8374-3cd28e89d2b5' class='xr-var-data-in' type='checkbox'><label for='data-85e862a4-a339-4836-8374-3cd28e89d2b5' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 691.88 kiB </td>
                        <td> 691.88 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (360, 492) </td>
                        <td> (360, 492) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 2 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="137" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="87" x2="120" y2="87" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="87" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="87" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,87.80487804878048 0.0,87.80487804878048" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="107.804878" font-size="1.0rem" font-weight="100" text-anchor="middle" >492</text>
  <text x="140.000000" y="43.902439" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,140.000000,43.902439)">360</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>sweep_number</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-923330d0-12f9-4a69-af46-47bbd5ebca5f' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-923330d0-12f9-4a69-af46-47bbd5ebca5f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-42d38033-8862-46a4-9a7e-455ed8f499ad' class='xr-var-data-in' type='checkbox'><label for='data-42d38033-8862-46a4-9a7e-455ed8f499ad' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Sweep number</dd><dt><span>units :</span></dt><dd>count</dd><dt><span>standard_name :</span></dt><dd>sweep_number</dd></dl></div><div class='xr-var-data'><pre>[1 values with dtype=int64]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>fixed_angle</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-ce272dd3-bbb0-4474-987e-84d155c91c49' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-ce272dd3-bbb0-4474-987e-84d155c91c49' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b0e2ff6c-f317-4843-865b-d5551039c2bf' class='xr-var-data-in' type='checkbox'><label for='data-b0e2ff6c-f317-4843-865b-d5551039c2bf' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Target angle for sweep</dd><dt><span>units :</span></dt><dd>degrees</dd><dt><span>standard_name :</span></dt><dd>target_fixed_angle</dd></dl></div><div class='xr-var-data'><pre>[1 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>rays_are_indexed</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>|S32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-faf505c4-7247-45ce-8c05-5ea8b960cdb1' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-faf505c4-7247-45ce-8c05-5ea8b960cdb1' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-98151db6-8432-47f5-8296-591fc66112a1' class='xr-var-data-in' type='checkbox'><label for='data-98151db6-8432-47f5-8296-591fc66112a1' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Flag for indexed rays</dd><dt><span>units :</span></dt><dd>unitless</dd><dt><span>options :</span></dt><dd>true: rays are indexed to a regular grid, false: rays are not indexed to a regular grid</dd></dl></div><div class='xr-var-data'><pre>[1 values with dtype=|S32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>ray_angle_res</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-84318cfe-a5e4-47c7-b1d1-1ddb4726f847' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-84318cfe-a5e4-47c7-b1d1-1ddb4726f847' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-48bd2c03-fd7e-48f0-b9b7-f7b87ff8c767' class='xr-var-data-in' type='checkbox'><label for='data-48bd2c03-fd7e-48f0-b9b7-f7b87ff8c767' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Angular resolution between rays</dd><dt><span>units :</span></dt><dd>degrees</dd><dt><span>comment :</span></dt><dd>Only applicable when rays_are_indexed variable is true</dd></dl></div><div class='xr-var-data'><pre>[1 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>radar_beam_width_h</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-3547a0ef-e00c-48b2-85d4-85e62013e8f2' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-3547a0ef-e00c-48b2-85d4-85e62013e8f2' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e82c260d-190e-453e-af8f-3efa06055aa8' class='xr-var-data-in' type='checkbox'><label for='data-e82c260d-190e-453e-af8f-3efa06055aa8' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Antenna beam width H polarization</dd><dt><span>units :</span></dt><dd>degrees</dd><dt><span>meta_group :</span></dt><dd>radar_parameters</dd></dl></div><div class='xr-var-data'><pre>[1 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>radar_beam_width_v</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-97f4f03d-7448-4672-afb7-5305a5f98144' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-97f4f03d-7448-4672-afb7-5305a5f98144' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-76edc6c4-1bbe-40ee-bc14-a7fa0bde3642' class='xr-var-data-in' type='checkbox'><label for='data-76edc6c4-1bbe-40ee-bc14-a7fa0bde3642' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Antenna beam width V polarization</dd><dt><span>units :</span></dt><dd>degrees</dd><dt><span>meta_group :</span></dt><dd>radar_parameters</dd></dl></div><div class='xr-var-data'><pre>[1 values with dtype=float32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>pulse_width</span></div><div class='xr-var-dims'>(azimuth)</div><div class='xr-var-dtype'>timedelta64[ns]</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(360,), meta=np.ndarray&gt;</div><input id='attrs-7350c881-f0d9-4505-9e65-d762e1ba7090' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-7350c881-f0d9-4505-9e65-d762e1ba7090' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a5fcc698-e3e9-4afb-bf20-c996d1ef7e8c' class='xr-var-data-in' type='checkbox'><label for='data-a5fcc698-e3e9-4afb-bf20-c996d1ef7e8c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Pulse width</dd><dt><span>comments :</span></dt><dd>Pulse width</dd><dt><span>meta_group :</span></dt><dd>instrument_parameters</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 2.81 kiB </td>
                        <td> 2.81 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (360,) </td>
                        <td> (360,) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 2 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> timedelta64[ns] numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="75" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >360</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">1</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>nyquist_velocity</span></div><div class='xr-var-dims'>(azimuth)</div><div class='xr-var-dtype'>float32</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(360,), meta=np.ndarray&gt;</div><input id='attrs-99b1a203-ea29-4df4-9d1a-0fdfa28e3229' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-99b1a203-ea29-4df4-9d1a-0fdfa28e3229' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-159b0630-d241-4afd-a337-c37c268b25cf' class='xr-var-data-in' type='checkbox'><label for='data-159b0630-d241-4afd-a337-c37c268b25cf' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Nyquist velocity</dd><dt><span>units :</span></dt><dd>meters_per_second</dd><dt><span>comments :</span></dt><dd>Unambiguous velocity</dd><dt><span>meta_group :</span></dt><dd>instrument_parameters</dd></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 1.41 kiB </td>
                        <td> 1.41 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (360,) </td>
                        <td> (360,) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 2 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float32 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="75" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="25" x2="120" y2="25" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="25" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="25" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,25.412616514582485 0.0,25.412616514582485" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="45.412617" font-size="1.0rem" font-weight="100" text-anchor="middle" >360</text>
  <text x="140.000000" y="12.706308" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(0,140.000000,12.706308)">1</text>
</svg>
        </td>
    </tr>
</table></div></li><li class='xr-var-item'><div class='xr-var-name'><span>time_coverage_start</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>|S32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-bb9c74ce-feaf-4ad4-afc3-0345189054ba' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-bb9c74ce-feaf-4ad4-afc3-0345189054ba' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-8a5805f4-8e35-440c-bb3f-0eb75cd03264' class='xr-var-data-in' type='checkbox'><label for='data-8a5805f4-8e35-440c-bb3f-0eb75cd03264' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>UTC time of first ray in the file</dd><dt><span>units :</span></dt><dd>unitless</dd></dl></div><div class='xr-var-data'><pre>[1 values with dtype=|S32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>time_coverage_end</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>|S32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-de044ada-df8b-4a28-9175-e07487653171' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-de044ada-df8b-4a28-9175-e07487653171' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4450e612-306f-4379-8b41-fa6e122d9a52' class='xr-var-data-in' type='checkbox'><label for='data-4450e612-306f-4379-8b41-fa6e122d9a52' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>UTC time of last ray in the file</dd><dt><span>units :</span></dt><dd>unitless</dd></dl></div><div class='xr-var-data'><pre>[1 values with dtype=|S32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>volume_number</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>int32</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-6fa2fa10-63cb-431a-8c51-94858bd253be' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-6fa2fa10-63cb-431a-8c51-94858bd253be' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-31c6ed70-c328-47d6-8c55-605a60e5aa88' class='xr-var-data-in' type='checkbox'><label for='data-31c6ed70-c328-47d6-8c55-605a60e5aa88' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>Volume number</dd><dt><span>units :</span></dt><dd>unitless</dd></dl></div><div class='xr-var-data'><pre>[1 values with dtype=int32]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>CMAP</span></div><div class='xr-var-dims'>(azimuth, range)</div><div class='xr-var-dtype'>bool</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(360, 492), meta=np.ndarray&gt;</div><input id='attrs-e6aa2b7b-3296-4b12-92a0-3bec8aeb674b' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-e6aa2b7b-3296-4b12-92a0-3bec8aeb674b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-36146e87-81d1-4658-ae63-721139a8b74a' class='xr-var-data-in' type='checkbox'><label for='data-36146e87-81d1-4658-ae63-721139a8b74a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>
                    
                    <tr>
                        <th> Bytes </th>
                        <td> 172.97 kiB </td>
                        <td> 172.97 kiB </td>
                    </tr>
                    
                    <tr>
                        <th> Shape </th>
                        <td> (360, 492) </td>
                        <td> (360, 492) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 5 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> bool numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="170" height="137" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="0" y1="0" x2="120" y2="0" style="stroke-width:2" />
  <line x1="0" y1="87" x2="120" y2="87" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="0" y1="0" x2="0" y2="87" style="stroke-width:2" />
  <line x1="120" y1="0" x2="120" y2="87" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="0.0,0.0 120.0,0.0 120.0,87.80487804878048 0.0,87.80487804878048" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="60.000000" y="107.804878" font-size="1.0rem" font-weight="100" text-anchor="middle" >492</text>
  <text x="140.000000" y="43.902439" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,140.000000,43.902439)">360</text>
</svg>
        </td>
    </tr>
</table></div></li></ul></div></li><li class='xr-section-item'><input id='section-11caac2e-4c2f-4373-b06b-0d97e6755e42' class='xr-section-summary-in' type='checkbox'  ><label for='section-11caac2e-4c2f-4373-b06b-0d97e6755e42' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>range</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-e560b0a1-f3fc-45ac-beb3-75098645ddb4' class='xr-index-data-in' type='checkbox'/><label for='index-e560b0a1-f3fc-45ac-beb3-75098645ddb4' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([249.99900817871094,  749.9970092773438, 1249.9949951171875,
       1749.9930419921875,  2249.990966796875,  2749.989013671875,
        3249.987060546875,  3749.985107421875,   4249.98291015625,
         4749.98095703125,
       ...
             241249.03125,       241749.03125,       242249.03125,
             242749.03125,       243249.03125,       243749.03125,
             244249.03125,      244749.015625,      245249.015625,
            245749.015625],
      dtype=&#x27;float32&#x27;, name=&#x27;range&#x27;, length=492))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>azimuth</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-b94fd04d-4d3e-40a0-847c-5aad7c4fcde1' class='xr-index-data-in' type='checkbox'/><label for='index-b94fd04d-4d3e-40a0-847c-5aad7c4fcde1' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([0.5246051549911499, 1.5271228551864624, 2.5241475105285645,
        3.526665210723877, 4.5374226570129395,  5.534447193145752,
       6.5232319831848145,  7.525749683380127,  8.536507606506348,
         9.54177188873291,
       ...
        350.5296325683594, 351.53765869140625,   352.545654296875,
        353.5372009277344,  354.5342102050781, 355.54498291015625,
       356.53924560546875,  357.5280456542969,  358.5278015136719,
         359.527587890625],
      dtype=&#x27;float32&#x27;, name=&#x27;azimuth&#x27;, length=360))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>frequency</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-c3b72fa4-267d-48fc-a149-eaefdf339aed' class='xr-index-data-in' type='checkbox'/><label for='index-c3b72fa4-267d-48fc-a149-eaefdf339aed' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Index([5450772000.0], dtype=&#x27;float32&#x27;, name=&#x27;frequency&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-bb1cf050-924a-456e-940d-241056322368' class='xr-section-summary-in' type='checkbox'  checked><label for='section-bb1cf050-924a-456e-940d-241056322368' class='xr-section-summary' >Attributes: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>fixed_angle :</span></dt><dd>-0.2</dd></dl></div></li></ul></div></div></div></div>
</div>
</div>
<div class="section" id="plot-reflectivities-clutter-and-cluttermap">
<h3>Plot Reflectivities, Clutter and Cluttermap<a class="headerlink" href="#plot-reflectivities-clutter-and-cluttermap" title="Permalink to this headline"><i class="fas fa-link"></i></a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">osgeo</span> <span class="kn">import</span> <span class="n">osr</span>

<span class="n">wgs84</span> <span class="o">=</span> <span class="n">osr</span><span class="o">.</span><span class="n">SpatialReference</span><span class="p">()</span>
<span class="n">wgs84</span><span class="o">.</span><span class="n">ImportFromEPSG</span><span class="p">(</span><span class="mi">4326</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>

<span class="n">swpx</span> <span class="o">=</span> <span class="n">swp</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="nb">range</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100000</span><span class="p">))</span><span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">wrl</span><span class="o">.</span><span class="n">georef</span><span class="o">.</span><span class="n">georeference_dataset</span><span class="p">,</span> <span class="n">proj</span><span class="o">=</span><span class="n">wgs84</span><span class="p">)</span>

<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">221</span><span class="p">)</span>
<span class="n">swpx</span><span class="o">.</span><span class="n">reflectivity_hh_clut</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">60</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Reflectivity raw&quot;</span><span class="p">)</span>

<span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">222</span><span class="p">)</span>
<span class="n">swpx</span><span class="o">.</span><span class="n">CMAP</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax2</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Cluttermap&quot;</span><span class="p">)</span>

<span class="n">ax3</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">223</span><span class="p">)</span>
<span class="n">swpx</span><span class="o">.</span><span class="n">reflectivity_hh_clut</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">swpx</span><span class="o">.</span><span class="n">CMAP</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax3</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">60</span>
<span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Clutter&quot;</span><span class="p">)</span>

<span class="n">ax4</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">224</span><span class="p">)</span>
<span class="n">swpx</span><span class="o">.</span><span class="n">reflectivity_hh_clut</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">swpx</span><span class="o">.</span><span class="n">CMAP</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax4</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">60</span>
<span class="p">)</span>
<span class="n">ax4</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Reflectivity clutter removed&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">RuntimeError</span><span class="g g-Whitespace">                              </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">11</span><span class="p">],</span> <span class="n">line</span> <span class="mi">3</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
<span class="ne">----&gt; </span><span class="mi">3</span> <span class="n">swpx</span> <span class="o">=</span> <span class="n">swp</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="nb">range</span><span class="o">=</span><span class="nb">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100000</span><span class="p">))</span><span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">wrl</span><span class="o">.</span><span class="n">georef</span><span class="o">.</span><span class="n">georeference_dataset</span><span class="p">,</span> <span class="n">proj</span><span class="o">=</span><span class="n">wgs84</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> <span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">221</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">6</span> <span class="n">swpx</span><span class="o">.</span><span class="n">reflectivity_hh_clut</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">60</span><span class="p">)</span>

<span class="nn">File /srv/conda/envs/notebook/lib/python3.9/site-packages/xarray/core/common.py:775,</span> in <span class="ni">DataWithCoords.pipe</span><span class="nt">(self, func, *args, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">773</span>     <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">774</span> <span class="k">else</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">775</span>     <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<span class="nn">File /srv/conda/envs/notebook/lib/python3.9/site-packages/wradlib/georef/xarray.py:184,</span> in <span class="ni">georeference_dataset</span><span class="nt">(obj, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">182</span> <span class="c1"># GDAL OSR, convert to this proj</span>
<span class="g g-Whitespace">    </span><span class="mi">183</span> <span class="k">if</span> <span class="n">has_import</span><span class="p">(</span><span class="n">osr</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">proj</span><span class="p">,</span> <span class="n">osr</span><span class="o">.</span><span class="n">SpatialReference</span><span class="p">):</span>
<span class="ne">--&gt; </span><span class="mi">184</span>     <span class="n">xyz</span> <span class="o">=</span> <span class="n">polar</span><span class="o">.</span><span class="n">spherical_to_proj</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">185</span>         <span class="n">r</span><span class="p">,</span> <span class="n">az</span><span class="p">,</span> <span class="n">obj</span><span class="p">[</span><span class="s2">&quot;elevation&quot;</span><span class="p">],</span> <span class="n">site</span><span class="p">,</span> <span class="n">proj</span><span class="o">=</span><span class="n">proj</span><span class="p">,</span> <span class="n">re</span><span class="o">=</span><span class="n">re</span><span class="p">,</span> <span class="n">ke</span><span class="o">=</span><span class="n">ke</span>
<span class="g g-Whitespace">    </span><span class="mi">186</span>     <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">187</span> <span class="c1"># other proj, convert to aeqd</span>
<span class="g g-Whitespace">    </span><span class="mi">188</span> <span class="k">elif</span> <span class="n">proj</span><span class="p">:</span>

<span class="nn">File /srv/conda/envs/notebook/lib/python3.9/site-packages/wradlib/georef/polar.py:228,</span> in <span class="ni">spherical_to_proj</span><span class="nt">(r, phi, theta, sitecoords, proj, re, ke)</span>
<span class="g g-Whitespace">    </span><span class="mi">225</span> <span class="k">if</span> <span class="n">proj</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">226</span>     <span class="n">proj</span> <span class="o">=</span> <span class="n">projection</span><span class="o">.</span><span class="n">get_default_projection</span><span class="p">()</span>
<span class="ne">--&gt; </span><span class="mi">228</span> <span class="n">xyz</span><span class="p">,</span> <span class="n">rad</span> <span class="o">=</span> <span class="n">spherical_to_xyz</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">sitecoords</span><span class="p">,</span> <span class="n">re</span><span class="o">=</span><span class="n">re</span><span class="p">,</span> <span class="n">ke</span><span class="o">=</span><span class="n">ke</span><span class="p">,</span> <span class="n">squeeze</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">230</span> <span class="c1"># reproject aeqd to destination projection</span>
<span class="g g-Whitespace">    </span><span class="mi">231</span> <span class="n">coords</span> <span class="o">=</span> <span class="n">projection</span><span class="o">.</span><span class="n">reproject</span><span class="p">(</span><span class="n">xyz</span><span class="p">,</span> <span class="n">projection_source</span><span class="o">=</span><span class="n">rad</span><span class="p">,</span> <span class="n">projection_target</span><span class="o">=</span><span class="n">proj</span><span class="p">)</span>

<span class="nn">File /srv/conda/envs/notebook/lib/python3.9/site-packages/wradlib/georef/polar.py:106,</span> in <span class="ni">spherical_to_xyz</span><span class="nt">(r, phi, theta, sitecoords, re, ke, squeeze, strict_dims)</span>
<span class="g g-Whitespace">    </span><span class="mi">104</span> <span class="n">osr</span> <span class="o">=</span> <span class="n">import_optional</span><span class="p">(</span><span class="s2">&quot;osgeo.osr&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">105</span> <span class="k">if</span> <span class="n">has_import</span><span class="p">(</span><span class="n">osr</span><span class="p">):</span>
<span class="ne">--&gt; </span><span class="mi">106</span>     <span class="n">rad</span> <span class="o">=</span> <span class="n">projection</span><span class="o">.</span><span class="n">proj4_to_osr</span><span class="p">(</span><span class="n">projstr</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">107</span> <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">108</span>     <span class="n">rad</span> <span class="o">=</span> <span class="n">projstr</span>

<span class="nn">File /srv/conda/envs/notebook/lib/python3.9/site-packages/wradlib/georef/projection.py:206,</span> in <span class="ni">proj4_to_osr</span><span class="nt">(proj4str)</span>
<span class="g g-Whitespace">    </span><span class="mi">204</span> <span class="n">proj</span> <span class="o">=</span> <span class="n">osr</span><span class="o">.</span><span class="n">SpatialReference</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">205</span> <span class="n">proj</span><span class="o">.</span><span class="n">ImportFromProj4</span><span class="p">(</span><span class="n">proj4str</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">206</span> <span class="n">proj</span><span class="o">.</span><span class="n">AutoIdentifyEPSG</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">208</span> <span class="k">if</span> <span class="n">proj</span><span class="o">.</span><span class="n">Validate</span><span class="p">()</span> <span class="o">==</span> <span class="n">ogr</span><span class="o">.</span><span class="n">OGRERR_CORRUPT_DATA</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">209</span>     <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
<span class="g g-Whitespace">    </span><span class="mi">210</span>         <span class="s2">&quot;proj4str validates to &#39;ogr.OGRERR_CORRUPT_DATA&#39;&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">211</span>         <span class="s2">&quot;and can&#39;t be imported as OSR object&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">212</span>     <span class="p">)</span>

<span class="nn">File /srv/conda/envs/notebook/lib/python3.9/site-packages/osgeo/osr.py:616,</span> in <span class="ni">SpatialReference.AutoIdentifyEPSG</span><span class="nt">(self, *args)</span>
<span class="g g-Whitespace">    </span><span class="mi">614</span> <span class="k">def</span> <span class="nf">AutoIdentifyEPSG</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">):</span>
<span class="g g-Whitespace">    </span><span class="mi">615</span><span class="w">     </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;AutoIdentifyEPSG(SpatialReference self) -&gt; OGRErr&quot;&quot;&quot;</span>
<span class="ne">--&gt; </span><span class="mi">616</span>     <span class="k">return</span> <span class="n">_osr</span><span class="o">.</span><span class="n">SpatialReference_AutoIdentifyEPSG</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">)</span>

<span class="ne">RuntimeError</span>: OGR Error: Unsupported SRS
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Figure size 1500x1200 with 0 Axes&gt;
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="srtm-based-clutter-and-beamblockage-processing">
<h2>SRTM based clutter and beamblockage processing<a class="headerlink" href="#srtm-based-clutter-and-beamblockage-processing" title="Permalink to this headline"><i class="fas fa-link"></i></a></h2>
<div class="section" id="download-needed-srtm-data">
<h3>Download needed SRTM data<a class="headerlink" href="#download-needed-srtm-data" title="Permalink to this headline"><i class="fas fa-link"></i></a></h3>
<p>For the course we already provide the needed SRTM tiles. For normal operation you would need a NASA EARTHDATA account and a connected bearer token.</p>
<p>The data will be loaded using GDAL machinery and transformed into an Xarray DataArray.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">extent</span> <span class="o">=</span> <span class="n">wrl</span><span class="o">.</span><span class="n">zonalstats</span><span class="o">.</span><span class="n">get_bbox</span><span class="p">(</span><span class="n">swpx</span><span class="o">.</span><span class="n">x</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">swpx</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="n">extent</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">12</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">extent</span> <span class="o">=</span> <span class="n">wrl</span><span class="o">.</span><span class="n">zonalstats</span><span class="o">.</span><span class="n">get_bbox</span><span class="p">(</span><span class="n">swpx</span><span class="o">.</span><span class="n">x</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">swpx</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">extent</span>

<span class="ne">NameError</span>: name &#39;swpx&#39; is not defined
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># apply fake token, data is already available</span>
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;WRADLIB_EARTHDATA_BEARER_TOKEN&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<span class="c1"># set location of wradlib-data, where wradlib will search for any available data</span>
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;WRADLIB_DATA&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;data/wradlib-data&quot;</span>
<span class="c1"># get the tiles</span>
<span class="n">dem</span> <span class="o">=</span> <span class="n">wrl</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">get_srtm</span><span class="p">(</span><span class="n">extent</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">13</span><span class="p">],</span> <span class="n">line</span> <span class="mi">6</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;WRADLIB_DATA&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;data/wradlib-data&quot;</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> <span class="c1"># get the tiles</span>
<span class="ne">----&gt; </span><span class="mi">6</span> <span class="n">dem</span> <span class="o">=</span> <span class="n">wrl</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">get_srtm</span><span class="p">(</span><span class="n">extent</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>

<span class="ne">NameError</span>: name &#39;extent&#39; is not defined
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">elevation</span> <span class="o">=</span> <span class="n">wrl</span><span class="o">.</span><span class="n">georef</span><span class="o">.</span><span class="n">read_gdal_values</span><span class="p">(</span><span class="n">dem</span><span class="p">)</span>
<span class="n">coords</span> <span class="o">=</span> <span class="n">wrl</span><span class="o">.</span><span class="n">georef</span><span class="o">.</span><span class="n">read_gdal_coordinates</span><span class="p">(</span><span class="n">dem</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">14</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">elevation</span> <span class="o">=</span> <span class="n">wrl</span><span class="o">.</span><span class="n">georef</span><span class="o">.</span><span class="n">read_gdal_values</span><span class="p">(</span><span class="n">dem</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">coords</span> <span class="o">=</span> <span class="n">wrl</span><span class="o">.</span><span class="n">georef</span><span class="o">.</span><span class="n">read_gdal_coordinates</span><span class="p">(</span><span class="n">dem</span><span class="p">)</span>

<span class="ne">NameError</span>: name &#39;dem&#39; is not defined
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">elev</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span>
    <span class="n">data</span><span class="o">=</span><span class="n">elevation</span><span class="p">,</span>
    <span class="n">dims</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">],</span>
    <span class="n">coords</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;lat&quot;</span><span class="p">:</span> <span class="p">([</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">],</span> <span class="n">coords</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span> <span class="s2">&quot;lon&quot;</span><span class="p">:</span> <span class="p">([</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">],</span> <span class="n">coords</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">])},</span>
<span class="p">)</span>
<span class="n">elev</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">15</span><span class="p">],</span> <span class="n">line</span> <span class="mi">2</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="n">elev</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">DataArray</span><span class="p">(</span>
<span class="ne">----&gt; </span><span class="mi">2</span>     <span class="n">data</span><span class="o">=</span><span class="n">elevation</span><span class="p">,</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span>     <span class="n">dims</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">],</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span>     <span class="n">coords</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;lat&quot;</span><span class="p">:</span> <span class="p">([</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">],</span> <span class="n">coords</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span> <span class="s2">&quot;lon&quot;</span><span class="p">:</span> <span class="p">([</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">],</span> <span class="n">coords</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">])},</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> <span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">6</span> <span class="n">elev</span>

<span class="ne">NameError</span>: name &#39;elevation&#39; is not defined
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="plot-clutter-on-dem">
<h3>Plot Clutter on DEM<a class="headerlink" href="#plot-clutter-on-dem" title="Permalink to this headline"><i class="fas fa-link"></i></a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>

<span class="n">swpx</span><span class="o">.</span><span class="n">CMAP</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">swpx</span><span class="o">.</span><span class="n">CMAP</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;turbo&quot;</span><span class="p">,</span> <span class="n">add_colorbar</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Reflectivity corr&quot;</span><span class="p">)</span>

<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">swpx</span><span class="o">.</span><span class="n">longitude</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">swpx</span><span class="o">.</span><span class="n">latitude</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;*&quot;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">)</span>

<span class="n">elev</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;lon&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;lat&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">,</span> <span class="n">zorder</span><span class="o">=-</span><span class="mi">2</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;terrain&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">16</span><span class="p">],</span> <span class="n">line</span> <span class="mi">4</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">13</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
<span class="ne">----&gt; </span><span class="mi">4</span> <span class="n">swpx</span><span class="o">.</span><span class="n">CMAP</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">swpx</span><span class="o">.</span><span class="n">CMAP</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span>     <span class="n">x</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;turbo&quot;</span><span class="p">,</span> <span class="n">add_colorbar</span><span class="o">=</span><span class="kc">False</span>
<span class="g g-Whitespace">      </span><span class="mi">6</span> <span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">7</span> <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Reflectivity corr&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">9</span> <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">swpx</span><span class="o">.</span><span class="n">longitude</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">swpx</span><span class="o">.</span><span class="n">latitude</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;*&quot;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">)</span>

<span class="ne">NameError</span>: name &#39;swpx&#39; is not defined
</pre></div>
</div>
<img alt="../../_images/9b1e7ce4029cab46f9a3ad25b0ff1ba3abed8527698013c994c5cfd9f5b2c48a.png" src="../../_images/9b1e7ce4029cab46f9a3ad25b0ff1ba3abed8527698013c994c5cfd9f5b2c48a.png" />
</div>
</div>
</div>
<div class="section" id="use-hvplot-for-interactive-zooming-and-panning">
<h3>Use hvplot for interactive zooming and panning<a class="headerlink" href="#use-hvplot-for-interactive-zooming-and-panning" title="Permalink to this headline"><i class="fas fa-link"></i></a></h3>
<p>Often it is desirable to quickly zoom and pan in the plots. Although matplotlib has that ability, it still is quite slow. Here <code class="docutils literal notranslate"><span class="pre">hvplot</span></code>, a <code class="docutils literal notranslate"><span class="pre">holoviews</span></code> based plotting framework, can be utilized. As frontend <code class="docutils literal notranslate"><span class="pre">bokeh</span></code> is used.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">hvplot</span>
<span class="kn">import</span> <span class="nn">hvplot.xarray</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/javascript">(function(root) {
  function now() {
    return new Date();
  }

  var force = true;
  var py_version = '3.1.1'.replace('rc', '-rc.');
  var is_dev = py_version.indexOf("+") !== -1 || py_version.indexOf("-") !== -1;
  var reloading = false;
  var Bokeh = root.Bokeh;
  var bokeh_loaded = Bokeh != null && (Bokeh.version === py_version || (Bokeh.versions !== undefined && Bokeh.versions.has(py_version)));

  if (typeof (root._bokeh_timeout) === "undefined" || force) {
    root._bokeh_timeout = Date.now() + 5000;
    root._bokeh_failed_load = false;
  }

  function run_callbacks() {
    try {
      root._bokeh_onload_callbacks.forEach(function(callback) {
        if (callback != null)
          callback();
      });
    } finally {
      delete root._bokeh_onload_callbacks;
    }
    console.debug("Bokeh: all callbacks have finished");
  }

  function load_libs(css_urls, js_urls, js_modules, js_exports, callback) {
    if (css_urls == null) css_urls = [];
    if (js_urls == null) js_urls = [];
    if (js_modules == null) js_modules = [];
    if (js_exports == null) js_exports = {};

    root._bokeh_onload_callbacks.push(callback);

    if (root._bokeh_is_loading > 0) {
      console.debug("Bokeh: BokehJS is being loaded, scheduling callback at", now());
      return null;
    }
    if (js_urls.length === 0 && js_modules.length === 0 && Object.keys(js_exports).length === 0) {
      run_callbacks();
      return null;
    }
    if (!reloading) {
      console.debug("Bokeh: BokehJS not loaded, scheduling load and callback at", now());
    }

    function on_load() {
      root._bokeh_is_loading--;
      if (root._bokeh_is_loading === 0) {
        console.debug("Bokeh: all BokehJS libraries/stylesheets loaded");
        run_callbacks()
      }
    }
    window._bokeh_on_load = on_load

    function on_error() {
      console.error("failed to load " + url);
    }

    var skip = [];
    if (window.requirejs) {
      window.requirejs.config({'packages': {}, 'paths': {'jspanel': 'https://cdn.jsdelivr.net/npm/jspanel4@4.12.0/dist/jspanel', 'jspanel-modal': 'https://cdn.jsdelivr.net/npm/jspanel4@4.12.0/dist/extensions/modal/jspanel.modal', 'jspanel-tooltip': 'https://cdn.jsdelivr.net/npm/jspanel4@4.12.0/dist/extensions/tooltip/jspanel.tooltip', 'jspanel-hint': 'https://cdn.jsdelivr.net/npm/jspanel4@4.12.0/dist/extensions/hint/jspanel.hint', 'jspanel-layout': 'https://cdn.jsdelivr.net/npm/jspanel4@4.12.0/dist/extensions/layout/jspanel.layout', 'jspanel-contextmenu': 'https://cdn.jsdelivr.net/npm/jspanel4@4.12.0/dist/extensions/contextmenu/jspanel.contextmenu', 'jspanel-dock': 'https://cdn.jsdelivr.net/npm/jspanel4@4.12.0/dist/extensions/dock/jspanel.dock', 'gridstack': 'https://cdn.jsdelivr.net/npm/gridstack@7.2.3/dist/gridstack-all', 'notyf': 'https://cdn.jsdelivr.net/npm/notyf@3/notyf.min'}, 'shim': {'jspanel': {'exports': 'jsPanel'}, 'gridstack': {'exports': 'GridStack'}}});
      require(["jspanel"], function(jsPanel) {
	window.jsPanel = jsPanel
	on_load()
      })
      require(["jspanel-modal"], function() {
	on_load()
      })
      require(["jspanel-tooltip"], function() {
	on_load()
      })
      require(["jspanel-hint"], function() {
	on_load()
      })
      require(["jspanel-layout"], function() {
	on_load()
      })
      require(["jspanel-contextmenu"], function() {
	on_load()
      })
      require(["jspanel-dock"], function() {
	on_load()
      })
      require(["gridstack"], function(GridStack) {
	window.GridStack = GridStack
	on_load()
      })
      require(["notyf"], function() {
	on_load()
      })
      root._bokeh_is_loading = css_urls.length + 9;
    } else {
      root._bokeh_is_loading = css_urls.length + js_urls.length + js_modules.length + Object.keys(js_exports).length;
    }

    var existing_stylesheets = []
    var links = document.getElementsByTagName('link')
    for (var i = 0; i < links.length; i++) {
      var link = links[i]
      if (link.href != null) {
	existing_stylesheets.push(link.href)
      }
    }
    for (var i = 0; i < css_urls.length; i++) {
      var url = css_urls[i];
      if (existing_stylesheets.indexOf(url) !== -1) {
	on_load()
	continue;
      }
      const element = document.createElement("link");
      element.onload = on_load;
      element.onerror = on_error;
      element.rel = "stylesheet";
      element.type = "text/css";
      element.href = url;
      console.debug("Bokeh: injecting link tag for BokehJS stylesheet: ", url);
      document.body.appendChild(element);
    }    if (((window['jsPanel'] !== undefined) && (!(window['jsPanel'] instanceof HTMLElement))) || window.requirejs) {
      var urls = ['https://cdn.holoviz.org/panel/1.1.0/dist/bundled/floatpanel/jspanel4@4.12.0/dist/jspanel.js', 'https://cdn.holoviz.org/panel/1.1.0/dist/bundled/floatpanel/jspanel4@4.12.0/dist/extensions/modal/jspanel.modal.js', 'https://cdn.holoviz.org/panel/1.1.0/dist/bundled/floatpanel/jspanel4@4.12.0/dist/extensions/tooltip/jspanel.tooltip.js', 'https://cdn.holoviz.org/panel/1.1.0/dist/bundled/floatpanel/jspanel4@4.12.0/dist/extensions/hint/jspanel.hint.js', 'https://cdn.holoviz.org/panel/1.1.0/dist/bundled/floatpanel/jspanel4@4.12.0/dist/extensions/layout/jspanel.layout.js', 'https://cdn.holoviz.org/panel/1.1.0/dist/bundled/floatpanel/jspanel4@4.12.0/dist/extensions/contextmenu/jspanel.contextmenu.js', 'https://cdn.holoviz.org/panel/1.1.0/dist/bundled/floatpanel/jspanel4@4.12.0/dist/extensions/dock/jspanel.dock.js'];
      for (var i = 0; i < urls.length; i++) {
        skip.push(urls[i])
      }
    }    if (((window['GridStack'] !== undefined) && (!(window['GridStack'] instanceof HTMLElement))) || window.requirejs) {
      var urls = ['https://cdn.holoviz.org/panel/1.1.0/dist/bundled/gridstack/gridstack@7.2.3/dist/gridstack-all.js'];
      for (var i = 0; i < urls.length; i++) {
        skip.push(urls[i])
      }
    }    if (((window['Notyf'] !== undefined) && (!(window['Notyf'] instanceof HTMLElement))) || window.requirejs) {
      var urls = ['https://cdn.holoviz.org/panel/1.1.0/dist/bundled/notificationarea/notyf@3/notyf.min.js'];
      for (var i = 0; i < urls.length; i++) {
        skip.push(urls[i])
      }
    }    var existing_scripts = []
    var scripts = document.getElementsByTagName('script')
    for (var i = 0; i < scripts.length; i++) {
      var script = scripts[i]
      if (script.src != null) {
	existing_scripts.push(script.src)
      }
    }
    for (var i = 0; i < js_urls.length; i++) {
      var url = js_urls[i];
      if (skip.indexOf(url) !== -1 || existing_scripts.indexOf(url) !== -1) {
	if (!window.requirejs) {
	  on_load();
	}
	continue;
      }
      var element = document.createElement('script');
      element.onload = on_load;
      element.onerror = on_error;
      element.async = false;
      element.src = url;
      console.debug("Bokeh: injecting script tag for BokehJS library: ", url);
      document.head.appendChild(element);
    }
    for (var i = 0; i < js_modules.length; i++) {
      var url = js_modules[i];
      if (skip.indexOf(url) !== -1 || existing_scripts.indexOf(url) !== -1) {
	if (!window.requirejs) {
	  on_load();
	}
	continue;
      }
      var element = document.createElement('script');
      element.onload = on_load;
      element.onerror = on_error;
      element.async = false;
      element.src = url;
      element.type = "module";
      console.debug("Bokeh: injecting script tag for BokehJS library: ", url);
      document.head.appendChild(element);
    }
    for (const name in js_exports) {
      var url = js_exports[name];
      if (skip.indexOf(url) >= 0 || root[name] != null) {
	if (!window.requirejs) {
	  on_load();
	}
	continue;
      }
      var element = document.createElement('script');
      element.onerror = on_error;
      element.async = false;
      element.type = "module";
      console.debug("Bokeh: injecting script tag for BokehJS library: ", url);
      element.textContent = `
      import ${name} from "${url}"
      window.${name} = ${name}
      window._bokeh_on_load()
      `
      document.head.appendChild(element);
    }
    if (!js_urls.length && !js_modules.length) {
      on_load()
    }
  };

  function inject_raw_css(css) {
    const element = document.createElement("style");
    element.appendChild(document.createTextNode(css));
    document.body.appendChild(element);
  }

  var js_urls = ["https://cdn.bokeh.org/bokeh/release/bokeh-3.1.1.min.js", "https://cdn.bokeh.org/bokeh/release/bokeh-gl-3.1.1.min.js", "https://cdn.bokeh.org/bokeh/release/bokeh-widgets-3.1.1.min.js", "https://cdn.bokeh.org/bokeh/release/bokeh-tables-3.1.1.min.js", "https://cdn.holoviz.org/panel/1.1.0/dist/panel.min.js"];
  var js_modules = [];
  var js_exports = {};
  var css_urls = [];
  var inline_js = [    function(Bokeh) {
      Bokeh.set_log_level("info");
    },
function(Bokeh) {} // ensure no trailing comma for IE
  ];

  function run_inline_js() {
    if ((root.Bokeh !== undefined) || (force === true)) {
      for (var i = 0; i < inline_js.length; i++) {
        inline_js[i].call(root, root.Bokeh);
      }
      // Cache old bokeh versions
      if (Bokeh != undefined && !reloading) {
	var NewBokeh = root.Bokeh;
	if (Bokeh.versions === undefined) {
	  Bokeh.versions = new Map();
	}
	if (NewBokeh.version !== Bokeh.version) {
	  Bokeh.versions.set(NewBokeh.version, NewBokeh)
	}
	root.Bokeh = Bokeh;
      }} else if (Date.now() < root._bokeh_timeout) {
      setTimeout(run_inline_js, 100);
    } else if (!root._bokeh_failed_load) {
      console.log("Bokeh: BokehJS failed to load within specified timeout.");
      root._bokeh_failed_load = true;
    }
    root._bokeh_is_initializing = false
  }

  function load_or_wait() {
    // Implement a backoff loop that tries to ensure we do not load multiple
    // versions of Bokeh and its dependencies at the same time.
    // In recent versions we use the root._bokeh_is_initializing flag
    // to determine whether there is an ongoing attempt to initialize
    // bokeh, however for backward compatibility we also try to ensure
    // that we do not start loading a newer (Panel>=1.0 and Bokeh>3) version
    // before older versions are fully initialized.
    if (root._bokeh_is_initializing && Date.now() > root._bokeh_timeout) {
      root._bokeh_is_initializing = false;
      root._bokeh_onload_callbacks = undefined;
      console.log("Bokeh: BokehJS was loaded multiple times but one version failed to initialize.");
      load_or_wait();
    } else if (root._bokeh_is_initializing || (typeof root._bokeh_is_initializing === "undefined" && root._bokeh_onload_callbacks !== undefined)) {
      setTimeout(load_or_wait, 100);
    } else {
      Bokeh = root.Bokeh;
      bokeh_loaded = Bokeh != null && (Bokeh.version === py_version || (Bokeh.versions !== undefined && Bokeh.versions.has(py_version)));
      root._bokeh_is_initializing = true
      root._bokeh_onload_callbacks = []
      if (!reloading && (!bokeh_loaded || is_dev)) {
	root.Bokeh = undefined;
      }
      load_libs(css_urls, js_urls, js_modules, js_exports, function() {
	console.debug("Bokeh: BokehJS plotting callback run at", now());
	run_inline_js();
      });
    }
  }
  // Give older versions of the autoload script a head-start to ensure
  // they initialize before we start loading newer version.
  setTimeout(load_or_wait, 100)
}(window));</script><script type="application/javascript">
if ((window.PyViz === undefined) || (window.PyViz instanceof HTMLElement)) {
  window.PyViz = {comms: {}, comm_status:{}, kernels:{}, receivers: {}, plot_index: []}
}


    function JupyterCommManager() {
    }

    JupyterCommManager.prototype.register_target = function(plot_id, comm_id, msg_handler) {
      if (window.comm_manager || ((window.Jupyter !== undefined) && (Jupyter.notebook.kernel != null))) {
        var comm_manager = window.comm_manager || Jupyter.notebook.kernel.comm_manager;
        comm_manager.register_target(comm_id, function(comm) {
          comm.on_msg(msg_handler);
        });
      } else if ((plot_id in window.PyViz.kernels) && (window.PyViz.kernels[plot_id])) {
        window.PyViz.kernels[plot_id].registerCommTarget(comm_id, function(comm) {
          comm.onMsg = msg_handler;
        });
      } else if (typeof google != 'undefined' && google.colab.kernel != null) {
        google.colab.kernel.comms.registerTarget(comm_id, (comm) => {
          var messages = comm.messages[Symbol.asyncIterator]();
          function processIteratorResult(result) {
            var message = result.value;
            console.log(message)
            var content = {data: message.data, comm_id};
            var buffers = []
            for (var buffer of message.buffers || []) {
              buffers.push(new DataView(buffer))
            }
            var metadata = message.metadata || {};
            var msg = {content, buffers, metadata}
            msg_handler(msg);
            return messages.next().then(processIteratorResult);
          }
          return messages.next().then(processIteratorResult);
        })
      }
    }

    JupyterCommManager.prototype.get_client_comm = function(plot_id, comm_id, msg_handler) {
      if (comm_id in window.PyViz.comms) {
        return window.PyViz.comms[comm_id];
      } else if (window.comm_manager || ((window.Jupyter !== undefined) && (Jupyter.notebook.kernel != null))) {
        var comm_manager = window.comm_manager || Jupyter.notebook.kernel.comm_manager;
        var comm = comm_manager.new_comm(comm_id, {}, {}, {}, comm_id);
        if (msg_handler) {
          comm.on_msg(msg_handler);
        }
      } else if ((plot_id in window.PyViz.kernels) && (window.PyViz.kernels[plot_id])) {
        var comm = window.PyViz.kernels[plot_id].connectToComm(comm_id);
        comm.open();
        if (msg_handler) {
          comm.onMsg = msg_handler;
        }
      } else if (typeof google != 'undefined' && google.colab.kernel != null) {
        var comm_promise = google.colab.kernel.comms.open(comm_id)
        comm_promise.then((comm) => {
          window.PyViz.comms[comm_id] = comm;
          if (msg_handler) {
            var messages = comm.messages[Symbol.asyncIterator]();
            function processIteratorResult(result) {
              var message = result.value;
              var content = {data: message.data};
              var metadata = message.metadata || {comm_id};
              var msg = {content, metadata}
              msg_handler(msg);
              return messages.next().then(processIteratorResult);
            }
            return messages.next().then(processIteratorResult);
          }
        }) 
        var sendClosure = (data, metadata, buffers, disposeOnDone) => {
          return comm_promise.then((comm) => {
            comm.send(data, metadata, buffers, disposeOnDone);
          });
        };
        var comm = {
          send: sendClosure
        };
      }
      window.PyViz.comms[comm_id] = comm;
      return comm;
    }
    window.PyViz.comm_manager = new JupyterCommManager();
    


var JS_MIME_TYPE = 'application/javascript';
var HTML_MIME_TYPE = 'text/html';
var EXEC_MIME_TYPE = 'application/vnd.holoviews_exec.v0+json';
var CLASS_NAME = 'output';

/**
 * Render data to the DOM node
 */
function render(props, node) {
  var div = document.createElement("div");
  var script = document.createElement("script");
  node.appendChild(div);
  node.appendChild(script);
}

/**
 * Handle when a new output is added
 */
function handle_add_output(event, handle) {
  var output_area = handle.output_area;
  var output = handle.output;
  if ((output.data == undefined) || (!output.data.hasOwnProperty(EXEC_MIME_TYPE))) {
    return
  }
  var id = output.metadata[EXEC_MIME_TYPE]["id"];
  var toinsert = output_area.element.find("." + CLASS_NAME.split(' ')[0]);
  if (id !== undefined) {
    var nchildren = toinsert.length;
    var html_node = toinsert[nchildren-1].children[0];
    html_node.innerHTML = output.data[HTML_MIME_TYPE];
    var scripts = [];
    var nodelist = html_node.querySelectorAll("script");
    for (var i in nodelist) {
      if (nodelist.hasOwnProperty(i)) {
        scripts.push(nodelist[i])
      }
    }

    scripts.forEach( function (oldScript) {
      var newScript = document.createElement("script");
      var attrs = [];
      var nodemap = oldScript.attributes;
      for (var j in nodemap) {
        if (nodemap.hasOwnProperty(j)) {
          attrs.push(nodemap[j])
        }
      }
      attrs.forEach(function(attr) { newScript.setAttribute(attr.name, attr.value) });
      newScript.appendChild(document.createTextNode(oldScript.innerHTML));
      oldScript.parentNode.replaceChild(newScript, oldScript);
    });
    if (JS_MIME_TYPE in output.data) {
      toinsert[nchildren-1].children[1].textContent = output.data[JS_MIME_TYPE];
    }
    output_area._hv_plot_id = id;
    if ((window.Bokeh !== undefined) && (id in Bokeh.index)) {
      window.PyViz.plot_index[id] = Bokeh.index[id];
    } else {
      window.PyViz.plot_index[id] = null;
    }
  } else if (output.metadata[EXEC_MIME_TYPE]["server_id"] !== undefined) {
    var bk_div = document.createElement("div");
    bk_div.innerHTML = output.data[HTML_MIME_TYPE];
    var script_attrs = bk_div.children[0].attributes;
    for (var i = 0; i < script_attrs.length; i++) {
      toinsert[toinsert.length - 1].childNodes[1].setAttribute(script_attrs[i].name, script_attrs[i].value);
    }
    // store reference to server id on output_area
    output_area._bokeh_server_id = output.metadata[EXEC_MIME_TYPE]["server_id"];
  }
}

/**
 * Handle when an output is cleared or removed
 */
function handle_clear_output(event, handle) {
  var id = handle.cell.output_area._hv_plot_id;
  var server_id = handle.cell.output_area._bokeh_server_id;
  if (((id === undefined) || !(id in PyViz.plot_index)) && (server_id !== undefined)) { return; }
  var comm = window.PyViz.comm_manager.get_client_comm("hv-extension-comm", "hv-extension-comm", function () {});
  if (server_id !== null) {
    comm.send({event_type: 'server_delete', 'id': server_id});
    return;
  } else if (comm !== null) {
    comm.send({event_type: 'delete', 'id': id});
  }
  delete PyViz.plot_index[id];
  if ((window.Bokeh !== undefined) & (id in window.Bokeh.index)) {
    var doc = window.Bokeh.index[id].model.document
    doc.clear();
    const i = window.Bokeh.documents.indexOf(doc);
    if (i > -1) {
      window.Bokeh.documents.splice(i, 1);
    }
  }
}

/**
 * Handle kernel restart event
 */
function handle_kernel_cleanup(event, handle) {
  delete PyViz.comms["hv-extension-comm"];
  window.PyViz.plot_index = {}
}

/**
 * Handle update_display_data messages
 */
function handle_update_output(event, handle) {
  handle_clear_output(event, {cell: {output_area: handle.output_area}})
  handle_add_output(event, handle)
}

function register_renderer(events, OutputArea) {
  function append_mime(data, metadata, element) {
    // create a DOM node to render to
    var toinsert = this.create_output_subarea(
    metadata,
    CLASS_NAME,
    EXEC_MIME_TYPE
    );
    this.keyboard_manager.register_events(toinsert);
    // Render to node
    var props = {data: data, metadata: metadata[EXEC_MIME_TYPE]};
    render(props, toinsert[0]);
    element.append(toinsert);
    return toinsert
  }

  events.on('output_added.OutputArea', handle_add_output);
  events.on('output_updated.OutputArea', handle_update_output);
  events.on('clear_output.CodeCell', handle_clear_output);
  events.on('delete.Cell', handle_clear_output);
  events.on('kernel_ready.Kernel', handle_kernel_cleanup);

  OutputArea.prototype.register_mime_type(EXEC_MIME_TYPE, append_mime, {
    safe: true,
    index: 0
  });
}

if (window.Jupyter !== undefined) {
  try {
    var events = require('base/js/events');
    var OutputArea = require('notebook/js/outputarea').OutputArea;
    if (OutputArea.prototype.mime_types().indexOf(EXEC_MIME_TYPE) == -1) {
      register_renderer(events, OutputArea);
    }
  } catch(err) {
  }
}
</script><div class="output text_html"><style>*[data-root-id],
*[data-root-id] > * {
  box-sizing: border-box;
  font-family: var(--jp-ui-font-family);
  font-size: var(--jp-ui-font-size1);
  color: var(--vscode-editor-foreground, var(--jp-ui-font-color1));
}

/* Override VSCode background color */
.cell-output-ipywidget-background:has(> .cell-output-ipywidget-background
    > .lm-Widget
    > *[data-root-id]),
.cell-output-ipywidget-background:has(> .lm-Widget > *[data-root-id]) {
  background-color: transparent !important;
}
</style></div></div>
</div>
<p>We need to rechunk the coordinates as hvplot needs chunked variables and coords.</p>
<p>todo # vergleichbar machen mit beam blockage angle/entfernung</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cl</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">swpx</span><span class="o">.</span><span class="n">CMAP</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">swpx</span><span class="o">.</span><span class="n">CMAP</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
    <span class="o">.</span><span class="n">chunk</span><span class="p">(</span><span class="n">chunks</span><span class="o">=</span><span class="p">{})</span>
    <span class="o">.</span><span class="n">hvplot</span><span class="o">.</span><span class="n">quadmesh</span><span class="p">(</span>
        <span class="n">x</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;Reds&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">700</span><span class="p">,</span> <span class="n">clim</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span>
    <span class="p">)</span>
<span class="p">)</span>
<span class="n">dm</span> <span class="o">=</span> <span class="n">elev</span><span class="o">.</span><span class="n">hvplot</span><span class="o">.</span><span class="n">quadmesh</span><span class="p">(</span>
    <span class="n">x</span><span class="o">=</span><span class="s2">&quot;lon&quot;</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s2">&quot;lat&quot;</span><span class="p">,</span>
    <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;terrain&quot;</span><span class="p">,</span>
    <span class="n">width</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span>
    <span class="n">height</span><span class="o">=</span><span class="mi">700</span><span class="p">,</span>
    <span class="n">clim</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4000</span><span class="p">),</span>
    <span class="n">rasterize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">dm</span> <span class="o">*</span> <span class="n">cl</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">18</span><span class="p">],</span> <span class="n">line</span> <span class="mi">2</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="n">cl</span> <span class="o">=</span> <span class="p">(</span>
<span class="ne">----&gt; </span><span class="mi">2</span>     <span class="n">swpx</span><span class="o">.</span><span class="n">CMAP</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">swpx</span><span class="o">.</span><span class="n">CMAP</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span>     <span class="o">.</span><span class="n">chunk</span><span class="p">(</span><span class="n">chunks</span><span class="o">=</span><span class="p">{})</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span>     <span class="o">.</span><span class="n">hvplot</span><span class="o">.</span><span class="n">quadmesh</span><span class="p">(</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span>         <span class="n">x</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;Reds&quot;</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mi">800</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">700</span><span class="p">,</span> <span class="n">clim</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span>
<span class="g g-Whitespace">      </span><span class="mi">6</span>     <span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">7</span> <span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">8</span> <span class="n">dm</span> <span class="o">=</span> <span class="n">elev</span><span class="o">.</span><span class="n">hvplot</span><span class="o">.</span><span class="n">quadmesh</span><span class="p">(</span>
<span class="g g-Whitespace">      </span><span class="mi">9</span>     <span class="n">x</span><span class="o">=</span><span class="s2">&quot;lon&quot;</span><span class="p">,</span>
<span class="g g-Whitespace">     </span><span class="mi">10</span>     <span class="n">y</span><span class="o">=</span><span class="s2">&quot;lat&quot;</span><span class="p">,</span>
   <span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">15</span>     <span class="n">rasterize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="g g-Whitespace">     </span><span class="mi">16</span> <span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">17</span> <span class="n">dm</span> <span class="o">*</span> <span class="n">cl</span>

<span class="ne">NameError</span>: name &#39;swpx&#39; is not defined
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="convert-dem-to-spherical-coordinates">
<h3>Convert DEM to spherical coordinates<a class="headerlink" href="#convert-dem-to-spherical-coordinates" title="Permalink to this headline"><i class="fas fa-link"></i></a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sitecoords</span> <span class="o">=</span> <span class="p">(</span><span class="n">swpx</span><span class="o">.</span><span class="n">longitude</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">swpx</span><span class="o">.</span><span class="n">latitude</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">swpx</span><span class="o">.</span><span class="n">altitude</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">swpx</span><span class="o">.</span><span class="n">range</span><span class="o">.</span><span class="n">values</span>
<span class="n">az</span> <span class="o">=</span> <span class="n">swpx</span><span class="o">.</span><span class="n">azimuth</span><span class="o">.</span><span class="n">values</span>
<span class="n">bw</span> <span class="o">=</span> <span class="mf">0.8</span>
<span class="n">beamradius</span> <span class="o">=</span> <span class="n">wrl</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">half_power_radius</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">bw</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">19</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">sitecoords</span> <span class="o">=</span> <span class="p">(</span><span class="n">swpx</span><span class="o">.</span><span class="n">longitude</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">swpx</span><span class="o">.</span><span class="n">latitude</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">swpx</span><span class="o">.</span><span class="n">altitude</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">r</span> <span class="o">=</span> <span class="n">swpx</span><span class="o">.</span><span class="n">range</span><span class="o">.</span><span class="n">values</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="n">az</span> <span class="o">=</span> <span class="n">swpx</span><span class="o">.</span><span class="n">azimuth</span><span class="o">.</span><span class="n">values</span>

<span class="ne">NameError</span>: name &#39;swpx&#39; is not defined
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rastervalues</span><span class="p">,</span> <span class="n">rastercoords</span><span class="p">,</span> <span class="n">proj</span> <span class="o">=</span> <span class="n">wrl</span><span class="o">.</span><span class="n">georef</span><span class="o">.</span><span class="n">extract_raster_dataset</span><span class="p">(</span>
    <span class="n">dem</span><span class="p">,</span> <span class="n">nodata</span><span class="o">=-</span><span class="mf">32768.0</span>
<span class="p">)</span>

<span class="n">rlimits</span> <span class="o">=</span> <span class="p">(</span><span class="n">extent</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">],</span> <span class="n">extent</span><span class="p">[</span><span class="s2">&quot;bottom&quot;</span><span class="p">],</span> <span class="n">extent</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">],</span> <span class="n">extent</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">])</span>
<span class="c1"># Clip the region inside our bounding box</span>
<span class="n">ind</span> <span class="o">=</span> <span class="n">wrl</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">find_bbox_indices</span><span class="p">(</span><span class="n">rastercoords</span><span class="p">,</span> <span class="n">rlimits</span><span class="p">)</span>
<span class="n">rastercoords</span> <span class="o">=</span> <span class="n">rastercoords</span><span class="p">[</span><span class="n">ind</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">:</span> <span class="n">ind</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">ind</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">:</span> <span class="n">ind</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="o">...</span><span class="p">]</span>
<span class="n">rastervalues</span> <span class="o">=</span> <span class="n">rastervalues</span><span class="p">[</span><span class="n">ind</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">:</span> <span class="n">ind</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">ind</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">:</span> <span class="n">ind</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span>

<span class="n">polcoords</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dstack</span><span class="p">([</span><span class="n">swpx</span><span class="o">.</span><span class="n">x</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">swpx</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">values</span><span class="p">])</span>
<span class="c1"># Map rastervalues to polar grid points</span>
<span class="n">polarvalues</span> <span class="o">=</span> <span class="n">wrl</span><span class="o">.</span><span class="n">ipol</span><span class="o">.</span><span class="n">cart_to_irregular_spline</span><span class="p">(</span>
    <span class="n">rastercoords</span><span class="p">,</span> <span class="n">rastervalues</span><span class="p">,</span> <span class="n">polcoords</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">prefilter</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">20</span><span class="p">],</span> <span class="n">line</span> <span class="mi">2</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="n">rastervalues</span><span class="p">,</span> <span class="n">rastercoords</span><span class="p">,</span> <span class="n">proj</span> <span class="o">=</span> <span class="n">wrl</span><span class="o">.</span><span class="n">georef</span><span class="o">.</span><span class="n">extract_raster_dataset</span><span class="p">(</span>
<span class="ne">----&gt; </span><span class="mi">2</span>     <span class="n">dem</span><span class="p">,</span> <span class="n">nodata</span><span class="o">=-</span><span class="mf">32768.0</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> <span class="n">rlimits</span> <span class="o">=</span> <span class="p">(</span><span class="n">extent</span><span class="p">[</span><span class="s2">&quot;left&quot;</span><span class="p">],</span> <span class="n">extent</span><span class="p">[</span><span class="s2">&quot;bottom&quot;</span><span class="p">],</span> <span class="n">extent</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">],</span> <span class="n">extent</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">])</span>
<span class="g g-Whitespace">      </span><span class="mi">6</span> <span class="c1"># Clip the region inside our bounding box</span>

<span class="ne">NameError</span>: name &#39;dem&#39; is not defined
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="partial-and-cumulative-beamblockage">
<h3>Partial and Cumulative Beamblockage<a class="headerlink" href="#partial-and-cumulative-beamblockage" title="Permalink to this headline"><i class="fas fa-link"></i></a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">PBB</span> <span class="o">=</span> <span class="n">wrl</span><span class="o">.</span><span class="n">qual</span><span class="o">.</span><span class="n">beam_block_frac</span><span class="p">(</span><span class="n">polarvalues</span><span class="p">,</span> <span class="n">swpx</span><span class="o">.</span><span class="n">z</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">beamradius</span><span class="p">)</span>
<span class="n">PBB</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">masked_invalid</span><span class="p">(</span><span class="n">PBB</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">PBB</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">21</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">PBB</span> <span class="o">=</span> <span class="n">wrl</span><span class="o">.</span><span class="n">qual</span><span class="o">.</span><span class="n">beam_block_frac</span><span class="p">(</span><span class="n">polarvalues</span><span class="p">,</span> <span class="n">swpx</span><span class="o">.</span><span class="n">z</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">beamradius</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">PBB</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">masked_invalid</span><span class="p">(</span><span class="n">PBB</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="nb">print</span><span class="p">(</span><span class="n">PBB</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

<span class="ne">NameError</span>: name &#39;polarvalues&#39; is not defined
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">CBB</span> <span class="o">=</span> <span class="n">wrl</span><span class="o">.</span><span class="n">qual</span><span class="o">.</span><span class="n">cum_beam_block_frac</span><span class="p">(</span><span class="n">PBB</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">CBB</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">22</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">CBB</span> <span class="o">=</span> <span class="n">wrl</span><span class="o">.</span><span class="n">qual</span><span class="o">.</span><span class="n">cum_beam_block_frac</span><span class="p">(</span><span class="n">PBB</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="nb">print</span><span class="p">(</span><span class="n">CBB</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

<span class="ne">NameError</span>: name &#39;PBB&#39; is not defined
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="plotting-beamblockage">
<h3>Plotting Beamblockage<a class="headerlink" href="#plotting-beamblockage" title="Permalink to this headline"><i class="fas fa-link"></i></a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># just a little helper function to style x and y axes of our maps</span>
<span class="k">def</span> <span class="nf">annotate_map</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">cm</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">):</span>
    <span class="n">xticks</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_xticks</span><span class="p">()</span>
    <span class="n">ticks</span> <span class="o">=</span> <span class="p">(</span><span class="n">xticks</span> <span class="o">/</span> <span class="mi">1000</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">xticks</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">ticks</span><span class="p">)</span>
    <span class="n">yticks</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_yticks</span><span class="p">()</span>
    <span class="n">ticks</span> <span class="o">=</span> <span class="p">(</span><span class="n">yticks</span> <span class="o">/</span> <span class="mi">1000</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">yticks</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_yticklabels</span><span class="p">(</span><span class="n">ticks</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Kilometers&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Kilometers&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">cm</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">cm</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">title</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alt</span> <span class="o">=</span> <span class="n">swpx</span><span class="o">.</span><span class="n">z</span><span class="o">.</span><span class="n">values</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>

<span class="c1"># create subplots</span>
<span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<span class="n">ax2</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="n">ax3</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot2grid</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">colspan</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">rowspan</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># azimuth angle</span>
<span class="n">angle</span> <span class="o">=</span> <span class="mi">270</span>

<span class="c1"># Plot terrain (on ax1)</span>
<span class="n">ax1</span><span class="p">,</span> <span class="n">dem</span> <span class="o">=</span> <span class="n">wrl</span><span class="o">.</span><span class="n">vis</span><span class="o">.</span><span class="n">plot_ppi</span><span class="p">(</span>
    <span class="n">polarvalues</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="n">r</span><span class="p">,</span> <span class="n">az</span><span class="o">=</span><span class="n">az</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">mpl</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">terrain</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mf">0.0</span>
<span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">angle</span><span class="p">))</span> <span class="o">*</span> <span class="mf">1e5</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">radians</span><span class="p">(</span><span class="n">angle</span><span class="p">))</span> <span class="o">*</span> <span class="mf">1e5</span><span class="p">],</span> <span class="s2">&quot;r-&quot;</span>
<span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">sitecoords</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">sitecoords</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s2">&quot;ro&quot;</span><span class="p">)</span>
<span class="n">annotate_map</span><span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">dem</span><span class="p">,</span> <span class="s2">&quot;Terrain within </span><span class="si">{0}</span><span class="s2"> km range&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">r</span> <span class="o">/</span> <span class="mf">1000.0</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.1</span><span class="p">))</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">100000</span><span class="p">,</span> <span class="mi">100000</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">100000</span><span class="p">,</span> <span class="mi">100000</span><span class="p">)</span>

<span class="c1"># Plot CBB (on ax2)</span>
<span class="n">ax2</span><span class="p">,</span> <span class="n">cbb</span> <span class="o">=</span> <span class="n">wrl</span><span class="o">.</span><span class="n">vis</span><span class="o">.</span><span class="n">plot_ppi</span><span class="p">(</span><span class="n">CBB</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax2</span><span class="p">,</span> <span class="n">r</span><span class="o">=</span><span class="n">r</span><span class="p">,</span> <span class="n">az</span><span class="o">=</span><span class="n">az</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">mpl</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">PuRd</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">annotate_map</span><span class="p">(</span><span class="n">ax2</span><span class="p">,</span> <span class="n">cbb</span><span class="p">,</span> <span class="s2">&quot;Beam-Blockage Fraction&quot;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mi">100000</span><span class="p">,</span> <span class="mi">100000</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">100000</span><span class="p">,</span> <span class="mi">100000</span><span class="p">)</span>

<span class="c1"># Plot single ray terrain profile on ax3</span>
<span class="p">(</span><span class="n">bc</span><span class="p">,)</span> <span class="o">=</span> <span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r</span> <span class="o">/</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="n">alt</span><span class="p">[</span><span class="n">angle</span><span class="p">,</span> <span class="p">:],</span> <span class="s2">&quot;-b&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Beam Center&quot;</span><span class="p">)</span>
<span class="p">(</span><span class="n">b3db</span><span class="p">,)</span> <span class="o">=</span> <span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">r</span> <span class="o">/</span> <span class="mf">1000.0</span><span class="p">,</span>
    <span class="p">(</span><span class="n">alt</span><span class="p">[</span><span class="n">angle</span><span class="p">,</span> <span class="p">:]</span> <span class="o">+</span> <span class="n">beamradius</span><span class="p">),</span>
    <span class="s2">&quot;:b&quot;</span><span class="p">,</span>
    <span class="n">linewidth</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span>
    <span class="n">label</span><span class="o">=</span><span class="s2">&quot;3 dB Beam width&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r</span> <span class="o">/</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="p">(</span><span class="n">alt</span><span class="p">[</span><span class="n">angle</span><span class="p">,</span> <span class="p">:]</span> <span class="o">-</span> <span class="n">beamradius</span><span class="p">),</span> <span class="s2">&quot;:b&quot;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">r</span> <span class="o">/</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">polarvalues</span><span class="p">[</span><span class="n">angle</span><span class="p">,</span> <span class="p">:],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;0.75&quot;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">r</span> <span class="o">/</span> <span class="mf">1000.0</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.1</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mi">3000</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Range (km)&quot;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Altitude (m)&quot;</span><span class="p">)</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>

<span class="n">axb</span> <span class="o">=</span> <span class="n">ax3</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
<span class="p">(</span><span class="n">bbf</span><span class="p">,)</span> <span class="o">=</span> <span class="n">axb</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">r</span> <span class="o">/</span> <span class="mf">1000.0</span><span class="p">,</span> <span class="n">CBB</span><span class="p">[</span><span class="n">angle</span><span class="p">,</span> <span class="p">:],</span> <span class="s2">&quot;-g&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;BBF&quot;</span><span class="p">)</span>
<span class="n">axb</span><span class="o">.</span><span class="n">spines</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s2">&quot;g&quot;</span><span class="p">)</span>
<span class="n">axb</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="s2">&quot;g&quot;</span><span class="p">)</span>
<span class="n">axb</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Beam-blockage fraction&quot;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;g&quot;</span><span class="p">)</span>
<span class="n">axb</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
<span class="n">axb</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">r</span> <span class="o">/</span> <span class="mf">1000.0</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.1</span><span class="p">)</span>


<span class="n">legend</span> <span class="o">=</span> <span class="n">ax3</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span>
    <span class="p">(</span><span class="n">bc</span><span class="p">,</span> <span class="n">b3db</span><span class="p">,</span> <span class="n">bbf</span><span class="p">),</span>
    <span class="p">(</span><span class="s2">&quot;Beam Center&quot;</span><span class="p">,</span> <span class="s2">&quot;3 dB Beam width&quot;</span><span class="p">,</span> <span class="s2">&quot;BBF&quot;</span><span class="p">),</span>
    <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;upper left&quot;</span><span class="p">,</span>
    <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">24</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">alt</span> <span class="o">=</span> <span class="n">swpx</span><span class="o">.</span><span class="n">z</span><span class="o">.</span><span class="n">values</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="c1"># create subplots</span>

<span class="ne">NameError</span>: name &#39;swpx&#39; is not defined
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="plotting-beamblockage-on-curvelinear-grid">
<h3>Plotting Beamblockage on Curvelinear Grid<a class="headerlink" href="#plotting-beamblockage-on-curvelinear-grid" title="Permalink to this headline"><i class="fas fa-link"></i></a></h3>
<p>Here you get an better impression of the actual beam progression .</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">height_formatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">pos</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mi">6370000</span><span class="p">)</span> <span class="o">/</span> <span class="mi">1000</span>
    <span class="n">fmt_str</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{:g}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">fmt_str</span>


<span class="k">def</span> <span class="nf">range_formatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">pos</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">/</span> <span class="mf">1000.0</span>
    <span class="n">fmt_str</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">{:g}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">fmt_str</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

<span class="n">cgax</span><span class="p">,</span> <span class="n">caax</span><span class="p">,</span> <span class="n">paax</span> <span class="o">=</span> <span class="n">wrl</span><span class="o">.</span><span class="n">vis</span><span class="o">.</span><span class="n">create_cg</span><span class="p">(</span><span class="n">fig</span><span class="o">=</span><span class="n">fig</span><span class="p">,</span> <span class="n">rot</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># azimuth angle</span>
<span class="n">angle</span> <span class="o">=</span> <span class="mi">270</span>

<span class="c1"># fix grid_helper</span>
<span class="n">er</span> <span class="o">=</span> <span class="mi">6370000</span>
<span class="n">gh</span> <span class="o">=</span> <span class="n">cgax</span><span class="o">.</span><span class="n">get_grid_helper</span><span class="p">()</span>
<span class="n">gh</span><span class="o">.</span><span class="n">grid_finder</span><span class="o">.</span><span class="n">grid_locator2</span><span class="o">.</span><span class="n">_nbins</span> <span class="o">=</span> <span class="mi">80</span>
<span class="n">gh</span><span class="o">.</span><span class="n">grid_finder</span><span class="o">.</span><span class="n">grid_locator2</span><span class="o">.</span><span class="n">_steps</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>

<span class="c1"># calculate beam_height and arc_distance for ke=1</span>
<span class="c1"># means line of sight</span>
<span class="n">bhe</span> <span class="o">=</span> <span class="n">wrl</span><span class="o">.</span><span class="n">georef</span><span class="o">.</span><span class="n">bin_altitude</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">sitecoords</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">re</span><span class="o">=</span><span class="n">er</span><span class="p">,</span> <span class="n">ke</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
<span class="n">ade</span> <span class="o">=</span> <span class="n">wrl</span><span class="o">.</span><span class="n">georef</span><span class="o">.</span><span class="n">bin_distance</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">sitecoords</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">re</span><span class="o">=</span><span class="n">er</span><span class="p">,</span> <span class="n">ke</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
<span class="n">nn0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
<span class="c1"># for nice plotting we assume earth_radius = 6370000 m</span>
<span class="n">ecp</span> <span class="o">=</span> <span class="n">nn0</span> <span class="o">+</span> <span class="n">er</span>
<span class="c1"># theta (arc_distance sector angle)</span>
<span class="n">thetap</span> <span class="o">=</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">degrees</span><span class="p">(</span><span class="n">ade</span> <span class="o">/</span> <span class="n">er</span><span class="p">)</span> <span class="o">+</span> <span class="mf">90.0</span>

<span class="c1"># zero degree elevation with standard refraction</span>
<span class="n">bh0</span> <span class="o">=</span> <span class="n">wrl</span><span class="o">.</span><span class="n">georef</span><span class="o">.</span><span class="n">bin_altitude</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">sitecoords</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">re</span><span class="o">=</span><span class="n">er</span><span class="p">)</span>

<span class="c1"># plot (ecp is earth surface normal null)</span>
<span class="p">(</span><span class="n">bes</span><span class="p">,)</span> <span class="o">=</span> <span class="n">paax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">thetap</span><span class="p">,</span> <span class="n">ecp</span><span class="p">,</span> <span class="s2">&quot;-k&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Earth Surface NN&quot;</span><span class="p">)</span>
<span class="p">(</span><span class="n">bc</span><span class="p">,)</span> <span class="o">=</span> <span class="n">paax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">thetap</span><span class="p">,</span> <span class="n">ecp</span> <span class="o">+</span> <span class="n">alt</span><span class="p">[</span><span class="n">angle</span><span class="p">,</span> <span class="p">:],</span> <span class="s2">&quot;-b&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Beam Center&quot;</span><span class="p">)</span>
<span class="p">(</span><span class="n">bc0r</span><span class="p">,)</span> <span class="o">=</span> <span class="n">paax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">thetap</span><span class="p">,</span> <span class="n">ecp</span> <span class="o">+</span> <span class="n">bh0</span><span class="p">,</span> <span class="s2">&quot;-g&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;0 deg Refraction&quot;</span><span class="p">)</span>
<span class="p">(</span><span class="n">bc0n</span><span class="p">,)</span> <span class="o">=</span> <span class="n">paax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">thetap</span><span class="p">,</span> <span class="n">ecp</span> <span class="o">+</span> <span class="n">bhe</span><span class="p">,</span> <span class="s2">&quot;-r&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;0 deg line of sight&quot;</span><span class="p">)</span>
<span class="p">(</span><span class="n">b3db</span><span class="p">,)</span> <span class="o">=</span> <span class="n">paax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
    <span class="n">thetap</span><span class="p">,</span> <span class="n">ecp</span> <span class="o">+</span> <span class="n">alt</span><span class="p">[</span><span class="n">angle</span><span class="p">,</span> <span class="p">:]</span> <span class="o">+</span> <span class="n">beamradius</span><span class="p">,</span> <span class="s2">&quot;:b&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;+3 dB Beam width&quot;</span>
<span class="p">)</span>
<span class="n">paax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">thetap</span><span class="p">,</span> <span class="n">ecp</span> <span class="o">+</span> <span class="n">alt</span><span class="p">[</span><span class="n">angle</span><span class="p">,</span> <span class="p">:]</span> <span class="o">-</span> <span class="n">beamradius</span><span class="p">,</span> <span class="s2">&quot;:b&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;-3 dB Beam width&quot;</span><span class="p">)</span>

<span class="c1"># orography</span>
<span class="n">paax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">thetap</span><span class="p">,</span> <span class="n">ecp</span><span class="p">,</span> <span class="n">ecp</span> <span class="o">+</span> <span class="n">polarvalues</span><span class="p">[</span><span class="n">angle</span><span class="p">,</span> <span class="p">:],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;0.75&quot;</span><span class="p">)</span>

<span class="c1"># shape axes</span>
<span class="n">cgax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">ade</span><span class="p">))</span>
<span class="n">cgax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">([</span><span class="n">ecp</span><span class="o">.</span><span class="n">min</span><span class="p">()</span> <span class="o">-</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">ecp</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">+</span> <span class="mi">2500</span><span class="p">])</span>
<span class="n">caax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">)</span>
<span class="n">cgax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">)</span>
<span class="n">cgax</span><span class="o">.</span><span class="n">axis</span><span class="p">[</span><span class="s2">&quot;top&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">toggle</span><span class="p">(</span><span class="nb">all</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">caax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span>
    <span class="n">mpl</span><span class="o">.</span><span class="n">ticker</span><span class="o">.</span><span class="n">MaxNLocator</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span> <span class="n">nbins</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span> <span class="n">prune</span><span class="o">=</span><span class="s2">&quot;both&quot;</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">caax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">mpl</span><span class="o">.</span><span class="n">ticker</span><span class="o">.</span><span class="n">MaxNLocator</span><span class="p">())</span>
<span class="n">caax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">mpl</span><span class="o">.</span><span class="n">ticker</span><span class="o">.</span><span class="n">FuncFormatter</span><span class="p">(</span><span class="n">height_formatter</span><span class="p">))</span>
<span class="n">caax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_formatter</span><span class="p">(</span><span class="n">mpl</span><span class="o">.</span><span class="n">ticker</span><span class="o">.</span><span class="n">FuncFormatter</span><span class="p">(</span><span class="n">range_formatter</span><span class="p">))</span>

<span class="n">caax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;Range (km)&quot;</span><span class="p">)</span>
<span class="n">caax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s2">&quot;Altitude (km)&quot;</span><span class="p">)</span>

<span class="n">legend</span> <span class="o">=</span> <span class="n">paax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span>
    <span class="p">(</span><span class="n">bes</span><span class="p">,</span> <span class="n">bc0n</span><span class="p">,</span> <span class="n">bc0r</span><span class="p">,</span> <span class="n">bc</span><span class="p">,</span> <span class="n">b3db</span><span class="p">),</span>
    <span class="p">(</span>
        <span class="s2">&quot;Earth Surface NN&quot;</span><span class="p">,</span>
        <span class="s2">&quot;0 deg line of sight&quot;</span><span class="p">,</span>
        <span class="s2">&quot;0 deg std refraction&quot;</span><span class="p">,</span>
        <span class="s2">&quot;Beam Center&quot;</span><span class="p">,</span>
        <span class="s2">&quot;3 dB Beam width&quot;</span><span class="p">,</span>
    <span class="p">),</span>
    <span class="n">loc</span><span class="o">=</span><span class="s2">&quot;lower left&quot;</span><span class="p">,</span>
    <span class="n">fontsize</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">26</span><span class="p">],</span> <span class="n">line</span> <span class="mi">16</span>
<span class="g g-Whitespace">     </span><span class="mi">12</span> <span class="n">gh</span><span class="o">.</span><span class="n">grid_finder</span><span class="o">.</span><span class="n">grid_locator2</span><span class="o">.</span><span class="n">_steps</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>
<span class="g g-Whitespace">     </span><span class="mi">14</span> <span class="c1"># calculate beam_height and arc_distance for ke=1</span>
<span class="g g-Whitespace">     </span><span class="mi">15</span> <span class="c1"># means line of sight</span>
<span class="ne">---&gt; </span><span class="mi">16</span> <span class="n">bhe</span> <span class="o">=</span> <span class="n">wrl</span><span class="o">.</span><span class="n">georef</span><span class="o">.</span><span class="n">bin_altitude</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">sitecoords</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">re</span><span class="o">=</span><span class="n">er</span><span class="p">,</span> <span class="n">ke</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">17</span> <span class="n">ade</span> <span class="o">=</span> <span class="n">wrl</span><span class="o">.</span><span class="n">georef</span><span class="o">.</span><span class="n">bin_distance</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">sitecoords</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">re</span><span class="o">=</span><span class="n">er</span><span class="p">,</span> <span class="n">ke</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">18</span> <span class="n">nn0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>

<span class="ne">NameError</span>: name &#39;r&#39; is not defined
</pre></div>
</div>
<img alt="../../_images/e2fa63886680e5651e9d62163f04814b6c1ee7f463dfcf7602205c8dc3be0643.png" src="../../_images/e2fa63886680e5651e9d62163f04814b6c1ee7f463dfcf7602205c8dc3be0643.png" />
</div>
</div>
</div>
</div>
<div class="section" id="use-clutter-and-beamblockage-as-quality-index">
<h2>Use Clutter and Beamblockage as Quality Index<a class="headerlink" href="#use-clutter-and-beamblockage-as-quality-index" title="Permalink to this headline"><i class="fas fa-link"></i></a></h2>
<p>Simple masking with cumulative beam blockage and Gabella.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">swpx</span> <span class="o">=</span> <span class="n">swpx</span><span class="o">.</span><span class="n">assign</span><span class="p">({</span><span class="s2">&quot;CBB&quot;</span><span class="p">:</span> <span class="p">([</span><span class="s2">&quot;azimuth&quot;</span><span class="p">,</span> <span class="s2">&quot;range&quot;</span><span class="p">],</span> <span class="n">CBB</span><span class="p">)})</span>
<span class="c1"># recalculate georeferencing for AEQD</span>
<span class="n">swpx</span> <span class="o">=</span> <span class="n">swpx</span><span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">wrl</span><span class="o">.</span><span class="n">georef</span><span class="o">.</span><span class="n">georeference_dataset</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">27</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">swpx</span> <span class="o">=</span> <span class="n">swpx</span><span class="o">.</span><span class="n">assign</span><span class="p">({</span><span class="s2">&quot;CBB&quot;</span><span class="p">:</span> <span class="p">([</span><span class="s2">&quot;azimuth&quot;</span><span class="p">,</span> <span class="s2">&quot;range&quot;</span><span class="p">],</span> <span class="n">CBB</span><span class="p">)})</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="c1"># recalculate georeferencing for AEQD</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="n">swpx</span> <span class="o">=</span> <span class="n">swpx</span><span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="n">wrl</span><span class="o">.</span><span class="n">georef</span><span class="o">.</span><span class="n">georeference_dataset</span><span class="p">)</span>

<span class="ne">NameError</span>: name &#39;swpx&#39; is not defined
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

<span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
<span class="n">swpx</span><span class="o">.</span><span class="n">reflectivity</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;turbo&quot;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">60</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Signal Processor - </span><span class="si">{</span><span class="n">swpx</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;M8[s]&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s2">&quot;equal&quot;</span><span class="p">)</span>

<span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">122</span><span class="p">)</span>
<span class="c1"># CBB &gt; 0.5, CMAP == 1, RHOHV &lt; 0.8 is masked</span>
<span class="n">swpx</span><span class="o">.</span><span class="n">where</span><span class="p">(</span>
    <span class="p">(</span><span class="n">swpx</span><span class="o">.</span><span class="n">CBB</span> <span class="o">&lt;=</span> <span class="mf">0.5</span><span class="p">)</span>
    <span class="o">&amp;</span> <span class="p">(</span><span class="n">swpx</span><span class="o">.</span><span class="n">CMAP</span> <span class="o">&lt;</span> <span class="mf">1.0</span><span class="p">)</span>
    <span class="o">&amp;</span> <span class="p">(</span><span class="n">swpx</span><span class="o">.</span><span class="n">uncorrected_cross_correlation_ratio</span> <span class="o">&gt;=</span> <span class="mf">0.8</span><span class="p">)</span>
<span class="p">)</span><span class="o">.</span><span class="n">reflectivity_hh_clut</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax2</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;turbo&quot;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">60</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Gabella+CBB+RHOHV - </span><span class="si">{</span><span class="n">swpx</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;M8[s]&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s2">&quot;equal&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">28</span><span class="p">],</span> <span class="n">line</span> <span class="mi">4</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="n">ax1</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">121</span><span class="p">)</span>
<span class="ne">----&gt; </span><span class="mi">4</span> <span class="n">swpx</span><span class="o">.</span><span class="n">reflectivity</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;turbo&quot;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">60</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Signal Processor - </span><span class="si">{</span><span class="n">swpx</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">values</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;M8[s]&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">6</span> <span class="n">ax1</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">(</span><span class="s2">&quot;equal&quot;</span><span class="p">)</span>

<span class="ne">NameError</span>: name &#39;swpx&#39; is not defined
</pre></div>
</div>
<img alt="../../_images/05b51c941370067e3826299a184b7cb9f5c11a37ffe54d821028578ebc298304.png" src="../../_images/05b51c941370067e3826299a184b7cb9f5c11a37ffe54d821028578ebc298304.png" />
</div>
</div>
</div>
<hr class="docutils" />
<div class="section" id="summary">
<h2>Summary<a class="headerlink" href="#summary" title="Permalink to this headline"><i class="fas fa-link"></i></a></h2>
<p>We’ve just learned how to use <span class="math notranslate nohighlight">\(\omega radlib\)</span>’s Gabella clutter detection for single sweeps. Wrapping numpy based functions for use with <code class="docutils literal notranslate"><span class="pre">xarray.apply_ufunc</span></code> has been shown. We’ve looked into digital elevation maps and beam blockage calculations.</p>
<div class="section" id="whats-next">
<h3>What’s next?<a class="headerlink" href="#whats-next" title="Permalink to this headline"><i class="fas fa-link"></i></a></h3>
<p>In the next notebook we dive into processing of differential phase.</p>
</div>
</div>
<div class="section" id="resources-and-references">
<h2>Resources and references<a class="headerlink" href="#resources-and-references" title="Permalink to this headline"><i class="fas fa-link"></i></a></h2>
<ul class="simple">
<li><p><a class="reference external" href="https://urs.earthdata.nasa.gov/">SRTM - NASA - EARTHDATA</a></p></li>
<li><p><a class="reference external" href="https://docs.xarray.dev">xarray</a></p></li>
<li><p><a class="reference external" href="https://docs.xarray.dev/en/stable/generated/xarray.apply_ufunc.html">apply_ufunc</a></p></li>
<li><p><a class="reference external" href="https://docs.dask.org/">dask</a></p></li>
<li><p><a class="reference external" href="https://gdal.org/index.html">gdal</a></p></li>
<li><p><a class="reference external" href="https://hvplot.holoviz.org/">hvplot</a></p></li>
<li><p><a class="reference external" href="https://docs.wradlib.org/en/stable/notebooks/fileio/wradlib_xarray_backends.html">wradlib xarray backends</a></p></li>
<li><p><a class="reference external" href="https://ncar.github.io/CfRadial/">CfRadial1</a></p></li>
<li><p><a class="reference external" href="https://www.eumetnet.eu/activities/observations-programme/current-activities/opera/">OPERA ODIM_H5</a></p></li>
<li><p><a class="reference external" href="https://community.wmo.int/governance/commission-membership/commission-observation-infrastructure-and-information-systems-infcom/commission-infrastructure-officers/infcom-management-group/standing-committee-measurements-instrumentation-and-traceability-sc-mint/joint-expert-team">WMO JET-OWR</a></p></li>
</ul>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./notebooks/wradlib"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="wradlib_radar_data_io_vis.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">wradlib radar data io, visualisation, gridding and gis export</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="wradlib_differential_phase.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">wradlib Phase Processing - System PhiDP - ZPHI-Method</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </div>
          </div>
        </main>

      </div>
    </div>
  
  <script src="../../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

<footer class="footer">
  <div class="container-fluid m-0 p-0">
  
    <div class="footer-item">
    
  <div class="container-fluid footer-logos">
    <div class="container-xl">
      <div class="row d-flex flex-wrap align-items-center">
        <div class="d-flex col-lg-3 col-md-4 col-sm-6 p-2 mx-auto">
          <img alt="Meteoswiss" src="../../_images/meteoswiss_logo.svg" style="width: 100%">
        </div>
        <div class="d-flex col-lg-3 col-md-4 col-sm-6 p-2 mx-auto">
          <img alt="Meteofrance" src="../../_images/meteo-france.jpg" style="width: 100%">
        </div>
        <div class="d-flex col-lg-3 col-md-4 col-sm-6 p-2 mx-auto">
          <img alt="ARM" src="../../_images/arm_logo.png" style="width: 100%">
        </div>
        <div class="d-flex col-lg-3 col-md-4 col-sm-6 p-2 mx-auto">
          <img alt="Argonne" src="../../_images/argonne_logo.png" style="width: 100%">
        </div>
        <div class="d-flex col-lg-3 col-md-4 col-sm-6 p-2 mx-auto">
          <img alt="Bonne" src="../../_images/university_bonn.png" style="width: 100%">
        </div>
        <div class="d-flex col-lg-3 col-md-4 col-sm-6 p-2 mx-auto">
          <img alt="Canada" src="../../_images/environment_canada_logo.svg" style="width: 100%">
        </div>
        <div class="d-flex col-lg-3 col-md-4 col-sm-6 p-2 mx-auto">
          <img alt="NCAR" src="../../_images/NCAR-contemp-logo-blue.svg" style="width: 100%">
        </div>
      </div>
    </div>
  </div>
    </div>
  
    <div class="footer-item">
    
    </div>
  
    <div class="footer-item">
      <div class="container-fluid footer-info">
    <div class="container-xl">
      <div class="d-flex justify-content-center">
        <p class="py-1 m-0">
            &copy;&nbsp;2022.
        
          By The Open Radar Community.
        
          Last updated on 20 June 2023.
        </p>
      </div>
    </div>
  </div>
    </div>
  
    <div class="footer-item">
    
    </div>
  
  </div>
</footer>
  </body>
</html>